statement ok
CREATE SCHEMA tm

statement ok
CREATE TABLE tm.geoms (id serial, g geometry)

statement error
INSERT INTO tm.geoms(g) values ('POINT EMPTY')

statement ok
INSERT INTO tm.geoms(g) values ('LINESTRING EMPTY')

statement ok
INSERT INTO tm.geoms(g) values ('POLYGON EMPTY')

statement ok
INSERT INTO tm.geoms(g) values ('MULTIPOINT EMPTY')

statement ok
INSERT INTO tm.geoms(g) values ('MULTILINESTRING EMPTY')

statement ok
INSERT INTO tm.geoms(g) values ('MULTIPOLYGON EMPTY')

statement ok
INSERT INTO tm.geoms(g) values ('GEOMETRYCOLLECTION EMPTY')

statement error
INSERT INTO tm.geoms(g) values ('CIRCULARSTRING EMPTY')

statement error
INSERT INTO tm.geoms(g) values ('COMPOUNDCURVE EMPTY')

statement error
INSERT INTO tm.geoms(g) values ('CURVEPOLYGON EMPTY')

statement error
INSERT INTO tm.geoms(g) values ('MULTICURVE EMPTY')

statement error
INSERT INTO tm.geoms(g) values ('MULTISURFACE EMPTY')

statement ok
INSERT INTO tm.geoms(g) values ('POLYHEDRALSURFACE EMPTY')

statement error
INSERT INTO tm.geoms(g) values ('TRIANGLE EMPTY')

statement error
INSERT INTO tm.geoms(g) values ('TIN EMPTY')

statement error
INSERT INTO tm.geoms(g)
SELECT st_force3dz(g) FROM tm.geoms WHERE id < 15 ORDER BY id

statement error
INSERT INTO tm.geoms(g)
SELECT st_force3dm(g) FROM tm.geoms WHERE id < 15 ORDER BY id

statement error
INSERT INTO tm.geoms(g)
SELECT st_force4d(g) FROM tm.geoms WHERE id < 15 ORDER BY id

statement ok
INSERT INTO tm.geoms(g)
SELECT st_setsrid(g,4326) FROM tm.geoms ORDER BY id

statement error
COPY select * from tm.geoms INTO E'/Users/jennie/monet/mtest/geom/sql/pg_regression/Tests/tmpfile_1'

statement ok
CREATE TABLE tm.geoms_in AS SELECT * FROM tm.geoms WITH NO DATA

statement error
COPY INTO tm.geoms_in FROM E'/Users/jennie/monet/mtest/geom/sql/pg_regression/Tests/tmpfile_1'

statement error
SELECT 'geometry', count(*) FROM tm.geoms_in i, tm.geoms o WHERE i.id = o.id
 AND ST_OrderingEquals(i.g, o.g)

statement ok
CREATE TABLE tm.geogs AS SELECT id,g FROM tm.geoms
WHERE geometrytype(g) NOT LIKE '%CURVE%'
  AND geometrytype(g) NOT LIKE '%CIRCULAR%'
  AND geometrytype(g) NOT LIKE '%SURFACE%'
  AND geometrytype(g) NOT LIKE 'TRIANGLE%'
  AND geometrytype(g) NOT LIKE 'TIN%'
WITH DATA

statement error
COPY select * from tm.geogs INTO E'/Users/jennie/monet/mtest/geom/sql/pg_regression/Tests/tmpfile_2'

statement ok
CREATE TABLE tm.geogs_in AS SELECT * FROM tm.geogs WITH NO DATA

statement error
COPY INTO tm.geogs_in FROM E'/Users/jennie/monet/mtest/geom/sql/pg_regression/Tests/tmpfile_2'

statement error
SELECT 'geometry', count(*) FROM tm.geogs_in i, tm.geogs o WHERE i.id = o.id
 AND ST_OrderingEquals(i.g, o.g)

statement ok
DROP SCHEMA tm CASCADE


statement ok
COPY select * from tm.geoms INTO E'$QTSTSRCDIR/tmpfile_1';

statement ok
COPY INTO tm.geoms_in FROM E'$QTSTSRCDIR/tmpfile_1';

statement ok
COPY select * from tm.geogs INTO E'$QTSTSRCDIR/tmpfile_2';

statement ok
COPY INTO tm.geogs_in FROM E'$QTSTSRCDIR/tmpfile_2';


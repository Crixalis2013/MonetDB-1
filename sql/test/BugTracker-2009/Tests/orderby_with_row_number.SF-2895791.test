statement ok
create table "table1" ("customer" varchar(40), "product" varchar(40), "price" double)

statement ok
insert into "table1" values ('cust1', 'p1', 100)

statement ok
insert into "table1" values ('cust1', 'p2', 200)

statement ok
insert into "table1" values ('cust1', 'p3', 150)

statement ok
insert into "table1" values ('cust2', 'p1', 300)

statement ok
insert into "table1" values ('cust2', 'p3', 200)

query TTRI rowsort
SELECT "customer", "product", "sumprice", (Row_number() OVER(PARTITION BY "customer" ORDER BY "sumprice")) as "rank" FROM ( SELECT "customer", "product", (Sum("price")) AS "sumprice" FROM "table1" GROUP BY "customer", "product") AS "temp"
----
20 values hashing to 8da78df5921d9bb13c4b75294af9f6b7

statement ok
DROP TABLE "table1"



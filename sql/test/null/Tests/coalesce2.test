statement ok
CREATE TABLE my_table1 ( col1 VARCHAR(1) ) 

statement ok
CREATE TABLE my_table2 ( col1 VARCHAR(1) NOT NULL, col2 INT NOT NULL) 

statement ok
INSERT INTO my_table1 VALUES ('A') 

statement ok
INSERT INTO my_table1 VALUES ('B') 

statement ok
INSERT INTO my_table1 VALUES ('B') 

statement ok
INSERT INTO my_table1 VALUES ('C') 

statement ok
INSERT INTO my_table1 VALUES ('C') 

statement ok
INSERT INTO my_table1 VALUES ('C') 

statement ok
INSERT INTO my_table1 VALUES (NULL) 

statement ok
INSERT INTO my_table1 VALUES (NULL) 

statement ok
INSERT INTO my_table1 VALUES (NULL) 

statement ok
INSERT INTO my_table1 VALUES (NULL) 

statement ok
INSERT INTO my_table2 VALUES ('A', 1) 

statement ok
INSERT INTO my_table2 VALUES ('B', 2) 

statement ok
INSERT INTO my_table2 VALUES ('C', 3) 

query I rowsort
SELECT (SELECT y.col2 FROM my_table2 y WHERE y.col1 = x.col1) AS col1
FROM (
      SELECT * FROM my_table1
     ) x
----
10 values hashing to da0f81f3773ec10b245318fdf05e21ce

query I rowsort
SELECT COALESCE((SELECT y.col2 FROM my_table2 y WHERE y.col1 = x.col1),0) AS col1
FROM (
      SELECT * FROM my_table1
     ) x
----
10 values hashing to e0145663d590ae02decc8cdc9071e0c2

statement ok
DROP   TABLE my_table1 

statement ok
DROP   TABLE my_table2 


statement ok
START TRANSACTION

statement ok
CREATE TABLE "sys"."test_bug4058" (
       	"f1"   INTEGER       NOT NULL,
       	"f2"     INTEGER       NOT NULL,
       	"f3"   CHARACTER LARGE OBJECT NOT NULL,
       	"f4" BOOLEAN       NOT NULL
)

statement ok
INSERT INTO "sys"."test_bug4058" VALUES
(81,1310,'V',true),
(303,1205,'V',true),
(601,1502,'V',true),
(839,1312,'A',true),
(408,1302,'G',false),
(665,1410,'V',true),
(267,1604,'A',true),
(556,1208,'G',false),
(386,1409,'G',false),
(831,1606,'A',true),
(681,1509,'G',false),
(784,1511,'A',true),
(777,1503,'A',true),
(781,1407,'V',true),
(682,1402,'V',true),
(796,1507,'V',true),
(743,1505,'V',true),
(715,1409,'G',false),
(769,1402,'A',true),
(760,1511,'A',true)

query IITT rowsort
select * from "sys"."test_bug4058" limit 10
----
40 values hashing to 4906e28e4c76d00e9032e9e1b173aaa1

statement ok
create table "sys"."test_bug4058_tmp" as ( select * from "sys"."test_bug4058" limit 10)

query IITT rowsort
select * from (select * from "sys"."test_bug4058" where f3='V' AND f4=true) as tmp where f1||f2 NOT IN (select f1||f2 from "sys"."test_bug4058_tmp")
----
16 values hashing to 03ec192ebf2c2fc9c1fc2c7a5af73e21

query IITT rowsort
select * from (select * from "sys"."test_bug4058" where f1||f2 NOT IN (select f1||f2 from "sys"."test_bug4058_tmp")) as tmp where f3='V' AND f4=true
----
16 values hashing to 03ec192ebf2c2fc9c1fc2c7a5af73e21

query IITT rowsort
select * from "sys"."test_bug4058" where f3='V' AND f4=true AND f1||f2 NOT IN (select f1||f2 from "sys"."test_bug4058_tmp")
----
16 values hashing to 03ec192ebf2c2fc9c1fc2c7a5af73e21

statement ok
DROP TABLE "sys"."test_bug4058_tmp"

statement ok
DROP TABLE "sys"."test_bug4058"

statement ok
ROLLBACK



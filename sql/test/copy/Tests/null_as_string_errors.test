statement ok
create table null_as_string (i int, s string, d decimal(5,2))

statement error
copy 1 records into null_as_string from stdin delimiters ',',E'\n' NULL as ''
<COPY_INTO_DATA>
NULL,NULL,NULL

query IITT rowsort
select * from sys.rejects
----
1
1
line 1 field i 'int' expected in 'NULL'
NULL,NULL,NULL@

query IITT rowsort
call sys.clearrejects()
----
1
1
line 1 field i 'int' expected in 'NULL'
NULL,NULL,NULL@

statement error
copy 1 records into null_as_string from stdin delimiters ',',E'\n' NULL as ''
<COPY_INTO_DATA>
NULL,zero,0

query IITT rowsort
select * from sys.rejects
----
1
1
line 1 field i 'int' expected in 'NULL'
NULL,zero,0@

query IITT rowsort
call sys.clearrejects()
----
1
1
line 1 field i 'int' expected in 'NULL'
NULL,zero,0@

statement ok
copy 1 records into null_as_string from stdin delimiters ',',E'\n' NULL as ''
<COPY_INTO_DATA>
1,NULL,1

query IITT rowsort
select * from sys.rejects
----

query IITT rowsort
call sys.clearrejects()
----

statement error
copy 1 records into null_as_string from stdin delimiters ',',E'\n' NULL as ''
<COPY_INTO_DATA>
2,two,NULL

query ITR rowsort
select * from null_as_string
----
1
NULL
1.000

statement ok
delete from null_as_string

query IITT rowsort
select * from sys.rejects
----
1
3
line 1 field d 'decimal(5,2)' expected in 'NULL'
2,two,NULL@

query IITT rowsort
call sys.clearrejects()
----
1
3
line 1 field d 'decimal(5,2)' expected in 'NULL'
2,two,NULL@

query IITT rowsort
copy 1 records into null_as_string from stdin delimiters ',',E'\n' best effort;
,,
select * from sys.rejects;
call sys.clearrejects();
----
1
1
line 1 field i 'int' expected in ''
,,@

query IITT rowsort
copy 1 records into null_as_string from stdin delimiters ',',E'\n' best effort;
,zero,0
select * from sys.rejects;
call sys.clearrejects();
----
1
1
line 1 field i 'int' expected in ''
,zero,0@

query IITT rowsort
copy 1 records into null_as_string from stdin delimiters ',',E'\n' best effort;
1,,1
select * from sys.rejects;
call sys.clearrejects();
----

statement ok
copy 1 records into null_as_string from stdin delimiters ',',E'\n' best effort
<COPY_INTO_DATA>
2,two,

query ITR rowsort
select * from null_as_string
----
1
(empty)
1.000
2
two
0.000

statement ok
delete from null_as_string

query IITT rowsort
select * from sys.rejects
----

query IITT rowsort
call sys.clearrejects()
----

statement ok
drop table null_as_string



statement ok
CREATE TABLE sys.abc (a INT, b VARCHAR(10))

statement ok
INSERT INTO sys.abc VALUES (1, 'one')

statement ok
INSERT INTO sys.abc VALUES (2, 'two')

query IT rowsort
SELECT * FROM sys.abc
----
1
one
2
two

statement ok
DELETE FROM sys.statistics

statement ok
ANALYZE sys.abc

query TIIIIITTTT rowsort
SELECT   type, width,   "sample", "count", "unique", nils, minval, maxval, sorted, revsorted FROM sys.statistics
----
20 values hashing to dd6300a929beaf00a4dc41eaa61e30a3

query TIIIIITTTT rowsort
-- expected 2 rows
SELECT   type, width,   "sample", "count", "unique", nils, minval, maxval, sorted, revsorted FROM sys.statistics where column_id not in (select id from sys.columns)
----

statement ok
-- expected 0 rows
ALTER TABLE sys.abc DROP COLUMN b

query TIIIIITTTT rowsort
SELECT   type, width,   "sample", "count", "unique", nils, minval, maxval, sorted, revsorted FROM sys.statistics where column_id not in (select id from sys.columns)
----

statement ok
-- expected 0 rows but found 1 row !
DROP TABLE sys.abc CASCADE

query TIIIIITTTT rowsort
SELECT   type, width,   "sample", "count", "unique", nils, minval, maxval, sorted, revsorted FROM sys.statistics where column_id not in (select id from sys.columns)
----

query TIIIIITTTT rowsort
-- expected 0 rows but found 2 rows !
SELECT   type, width,   "sample", "count", "unique", nils, minval, maxval, sorted, revsorted FROM sys.statistics
----

statement ok
-- expected 0 rows but found 2 rows !
DELETE FROM sys.statistics



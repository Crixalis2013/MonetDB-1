statement ok
create table t1 (id int, name varchar(1024), age int, PRIMARY KEY(id))

statement ok
create table t2 (id int, age int, PRIMARY KEY (ID), FOREIGN KEY(id) REFERENCES t1(id))

statement ok
create view v1 as select * from t1

statement ok
create trigger test1 after insert on t2
	insert into t1 values(0, 'after', 23)

statement error
CREATE FUNCTION f1(num int)
RETURNS int
BEGIN
	IF num >0
		THEN RETURN 1

statement error
		ELSE RETURN 0

statement error
	END IF

statement error
END

statement error
CREATE FUNCTION f2()
RETURNS TABLE(id int)
BEGIN
	DECLARE TABLE f1_t1(id int)

statement error
	DECLARE x int

statement error
	SET x = 3

statement error
	IF f1(x) > 0
		THEN RETURN f1_t1

statement error
	END IF

statement error
	INSERT INTO f1_t1 VALUES(1)

statement error
	IF f1(x) < 0
		THEN RETURN f1_t1

statement error
	END IF

statement error
	RETURN TABLE (SELECT t1.id FROM v1, t1 WHERE v1.age > 10 AND t1.name LIKE 'monet')

statement error
END

statement ok
CREATE INDEX id_index ON t1(id)

statement ok
ALTER TABLE t1 DROP COLUMN id CASCADE

query T rowsort
select name from sys.tables where name = 't1'
----
t1

query T rowsort
select name from sys.tables where name = 't2'
----
t2

query T rowsort
select name from sys.tables where name = 'v1'
----

query T rowsort
select name from sys.functions where name = 'f2'
----

query T rowsort
select name from sys.triggers where name = 'test1'
----

query T rowsort
select name from sys.idxs where name = 'id_index'
----

query T rowsort
select name from sys.columns where name = 'id' and table_id in (select id from sys.tables where name = 't1' or name = 't2')
----
id

query T rowsort
select name from sys.keys where name not in ('files_pkey_file_id', 'sq_pkey_sn_file_id', 'sq_fkey_file_id', 'rg_pkey_id_file_id', 'rg_fkey_file_id', 'pg_pkey_id_file_id', 'pg_fkey_file_id', 'spatial_ref_sys_srid_pkey', 'comments_id_pkey')
----
16 values hashing to 280298940146bbe4f881b8e5f4419dc5

statement ok
drop table t1

statement ok
drop table t2

statement error
drop function f1



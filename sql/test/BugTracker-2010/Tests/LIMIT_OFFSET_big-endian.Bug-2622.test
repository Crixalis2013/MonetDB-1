statement ok
set optimizer = 'minimal_pipe'

statement ok
create table oblo (a int)

statement ok
insert into oblo values (4)

statement ok
insert into oblo values (3)

statement ok
insert into oblo values (2)

statement ok
insert into oblo values (1)

query T rowsort
   PLAN select * from oblo
----
) [ "oblo"."a" ]
project (
| table(sys.oblo) [ "oblo"."a" ] COUNT 

query T rowsort
   PLAN select * from oblo OFFSET 2
----
) [ "oblo"."a" ]
project (
| ) [ bigint "NULL", bigint "2" ]
| top N (
| | table(sys.oblo) [ "oblo"."a" ] COUNT 

query T rowsort
   PLAN select * from oblo LIMIT 2
----
) [ "oblo"."a" ]
project (
| ) [ bigint "2" ]
| top N (
| | table(sys.oblo) [ "oblo"."a" ] COUNT 

query T rowsort
   PLAN select * from oblo LIMIT 1 OFFSET 2
----
) [ "oblo"."a" ]
project (
| ) [ bigint "1", bigint "2" ]
| top N (
| | table(sys.oblo) [ "oblo"."a" ] COUNT 

query T rowsort
   PLAN select * from oblo LIMIT 2 OFFSET 1
----
) [ "oblo"."a" ]
project (
| ) [ bigint "2", bigint "1" ]
| top N (
| | table(sys.oblo) [ "oblo"."a" ] COUNT 

query T rowsort
   PLAN select * from oblo ORDER BY a
----
) [ "oblo"."a" ] [ "oblo"."a" ASC ]
project (
| table(sys.oblo) [ "oblo"."a" ] COUNT 

query T rowsort
   PLAN select * from oblo ORDER BY a OFFSET 2
----
) [ bigint "NULL", bigint "2" ]
top N (
| ) [ "oblo"."a" ] [ "oblo"."a" ASC ]
| project (
| | table(sys.oblo) [ "oblo"."a" ] COUNT 

query T rowsort
   PLAN select * from oblo ORDER BY a LIMIT 2
----
) [ bigint "2" ]
top N (
| ) [ "oblo"."a" ] [ "oblo"."a" ASC ]
| project (
| | table(sys.oblo) [ "oblo"."a" ] COUNT 

query T rowsort
   PLAN select * from oblo ORDER BY a LIMIT 2 OFFSET 1
----
) [ bigint "2", bigint "1" ]
top N (
| ) [ "oblo"."a" ] [ "oblo"."a" ASC ]
| project (
| | table(sys.oblo) [ "oblo"."a" ] COUNT 

query T rowsort
   PLAN select * from oblo ORDER BY a LIMIT 1 OFFSET 2
----
) [ bigint "1", bigint "2" ]
top N (
| ) [ "oblo"."a" ] [ "oblo"."a" ASC ]
| project (
| | table(sys.oblo) [ "oblo"."a" ] COUNT 

query T rowsort
EXPLAIN select * from oblo
----
26 values hashing to ebcde96c710ce41a3a41e01df44dad83

query T rowsort
EXPLAIN select * from oblo OFFSET 2
----
32 values hashing to c27a53ca10ccfd0d9bd0589e43640f9e

query T rowsort
EXPLAIN select * from oblo LIMIT 2
----
32 values hashing to 37b78da4384c09dfa3e3f871d7945069

query T rowsort
EXPLAIN select * from oblo LIMIT 1 OFFSET 2
----
32 values hashing to 63cef56a1a0d902f6e1bec7df8282e34

query T rowsort
EXPLAIN select * from oblo LIMIT 2 OFFSET 1
----
32 values hashing to b6e71196b356f95f360c63af5f9eecb7

query T rowsort
EXPLAIN select * from oblo ORDER BY a
----
30 values hashing to 358130ac394d5760d2b95cc2e203d111

query T rowsort
EXPLAIN select * from oblo ORDER BY a OFFSET 2
----
36 values hashing to 1f15a9fa6f4a60b07a0dd1740b12241f

query T rowsort
EXPLAIN select * from oblo ORDER BY a LIMIT 2
----
41 values hashing to e5ef5f97772d2182310e7adc85ca11af

query T rowsort
EXPLAIN select * from oblo ORDER BY a LIMIT 2 OFFSET 1
----
43 values hashing to bdd35ee192377448c950df5dd511365c

query T rowsort
EXPLAIN select * from oblo ORDER BY a LIMIT 1 OFFSET 2
----
43 values hashing to 90b778c279e8652c5422448d85843c85

query I rowsort
        select * from oblo
----
1
2
3
4

query I rowsort
        select * from oblo OFFSET 2
----
1
2

query I rowsort
        select * from oblo LIMIT 2
----
3
4

query I rowsort
        select * from oblo LIMIT 1 OFFSET 2
----
2

query I rowsort
        select * from oblo LIMIT 2 OFFSET 1
----
2
3

query I rowsort
        select * from oblo ORDER BY a
----
1
2
3
4

query I rowsort
        select * from oblo ORDER BY a OFFSET 2
----
3
4

query I rowsort
        select * from oblo ORDER BY a LIMIT 2
----
1
2

query I rowsort
        select * from oblo ORDER BY a LIMIT 2 OFFSET 1
----
2
3

query I rowsort
        select * from oblo ORDER BY a LIMIT 1 OFFSET 2
----
3

statement ok
drop table oblo



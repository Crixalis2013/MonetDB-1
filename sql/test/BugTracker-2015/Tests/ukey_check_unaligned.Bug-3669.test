statement ok
create table tab (id int not null, nm varchar(30) not null, dt date, qnt dec(18,10), descr text)

statement ok
insert into tab (id, nm) values (1, 'A')

statement ok
insert into tab (id, nm, dt, qnt, descr) values (2, 'B', '2015-01-29', 3.1415629, 'iasdfhiasdhagdsnfgankkkjfgjklfgjklsklsklsdfg')

query ITTRT rowsort
select * from tab
----
10 values hashing to e1ea07f5a43e5cd1884efbb4f32340fb

statement ok
insert into tab (id, nm, dt, qnt, descr) select id, nm, dt, qnt, descr from tab

query ITTRT rowsort
select * from tab
----
20 values hashing to 9e35969015c4754c9b25a8bae4193e2f

query IITTRT rowsort
select count(*) as count_dupl_rows, id, nm, dt, qnt, descr from tab
group by id, nm, dt, qnt, descr having count(*) > 1
order by id, nm, dt, qnt, descr
----
12 values hashing to 17c52db2501c9eddd93532fe581ef201

statement error
alter table tab add constraint tab_uc6 unique (id, nm, dt, qnt, descr)

statement ok
drop table tab



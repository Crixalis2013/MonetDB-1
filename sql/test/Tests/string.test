statement ok
create table stringtest ( str VARCHAR(20), str2 VARCHAR(20))

statement ok
insert into stringtest values ('', 'test')

statement ok
insert into stringtest values ('test', '')

statement ok
insert into stringtest values ('','')

statement ok
insert into stringtest values (' Test ','')

query TT rowsort
select * from stringtest
----
 Test 
(empty)
(empty)
(empty)
(empty)
test
test
(empty)

query IT rowsort
select length(str), str from stringtest
----
0
(empty)
0
(empty)
4
test
6
 Test 

query TT rowsort
select substring(str from 2 for 8), str2 from stringtest
----
(empty)
(empty)
(empty)
test
Test 
(empty)
est
(empty)

query TT rowsort
select substring(str, 2, 8), str2 from stringtest
----
(empty)
(empty)
(empty)
test
Test 
(empty)
est
(empty)

query TT rowsort
select substring(str from 2 for 1), str2 from stringtest
----
(empty)
(empty)
(empty)
test
T
(empty)
e
(empty)

query TT rowsort
select substring(str, 2, 1), str2 from stringtest
----
(empty)
(empty)
(empty)
test
T
(empty)
e
(empty)

query TT rowsort
select substring(str from 2), str2 from stringtest
----
(empty)
(empty)
(empty)
test
Test 
(empty)
est
(empty)

query TT rowsort
select substring(str, 2), str2 from stringtest
----
(empty)
(empty)
(empty)
test
Test 
(empty)
est
(empty)

query ITT rowsort
select position(str in str2), str, str2 from stringtest
----
12 values hashing to 71a3edc12cf3c9c51c1a208c2934ae8e

query ITT rowsort
select locate(str,str2), str, str2 from stringtest
----
12 values hashing to 71a3edc12cf3c9c51c1a208c2934ae8e

query IT rowsort
select ascii(str), str from stringtest
----
116
test
32
 Test 
NULL
(empty)
NULL
(empty)

query TT rowsort
select code(ascii(str)), str from stringtest
----
 
 Test 
NULL
(empty)
NULL
(empty)
t
test

query TT rowsort
select left(str,3), str from stringtest
----
 Te
 Test 
(empty)
(empty)
(empty)
(empty)
tes
test

query TT rowsort
select right(str,3), str from stringtest
----
(empty)
(empty)
(empty)
(empty)
est
test
st 
 Test 

query TT rowsort
select lower(str), str from stringtest
----
 test 
 Test 
(empty)
(empty)
(empty)
(empty)
test
test

query TT rowsort
select lcase(str), str from stringtest
----
 test 
 Test 
(empty)
(empty)
(empty)
(empty)
test
test

query TT rowsort
select upper(str), str from stringtest
----
 TEST 
 Test 
(empty)
(empty)
(empty)
(empty)
TEST
test

query TT rowsort
select ucase(str), str from stringtest
----
 TEST 
 Test 
(empty)
(empty)
(empty)
(empty)
TEST
test

query TT rowsort
select trim(str), str from stringtest
----
(empty)
(empty)
(empty)
(empty)
Test
 Test 
test
test

query TT rowsort
select ltrim(str), str from stringtest
----
(empty)
(empty)
(empty)
(empty)
Test 
 Test 
test
test

query TT rowsort
select rtrim(str), str from stringtest
----
 Test
 Test 
(empty)
(empty)
(empty)
(empty)
test
test

query TTT rowsort
select insert(str,2,4,str2), str, str2 from stringtest
----
12 values hashing to 11548d0cbdf2e34e6e1cdc0a7c4c637b

query TTT rowsort
select replace(str,'t',str), str, str2 from stringtest
----
12 values hashing to a85f8be04d0c3b5192ea7564380e6d11

query TT rowsort
select repeat(str,4), str from stringtest
----
 Test  Test  Test  Test 
 Test 
(empty)
(empty)
(empty)
(empty)
testtesttesttest
test

query IT rowsort
select ascii(4), str from stringtest
----
52
 Test 
52
(empty)
52
(empty)
52
test

query TTTTIII rowsort
select str,str2,soundex(str),soundex(str2), editdistance2(soundex(str),soundex(str2)), editdistance(soundex(str),soundex(str2)), difference(str,str2) from stringtest
----
28 values hashing to b386568a9481ea32f8c2da7dacddfc95

statement ok
insert into stringtest values ('monetdbiscool', 'coolismonetdb')

query ITT rowsort
select levenshtein(str,str2, 1, 2, 3), str, str2 from stringtest
----
15 values hashing to c3b88f52bab5e54a9f1a87560fb9e188

statement ok
insert into stringtest values ('monetdb45is+ cool', '  123123  123123  ')

query TTTT rowsort
select qgramnormalize(str) , qgramnormalize(str2), str, str2 from stringtest
----
24 values hashing to 4468aeb62c2b818c9939bb09499218c8

statement ok
drop table stringtest


statement ok
set optimizer='sequential_pipe'

statement ok
start transaction

query T rowsort
explain select name,func from functions where name like '%optimizers%'
----
49 values hashing to 7bf4ea35185281fd500ceb5ede3ecfd1

query T rowsort
explain select name,func from functions where name not like '%optimizers%'
----
49 values hashing to fc7c03cc3738e8a40ff5b3c542e1853c

query T rowsort
explain select name,func from functions where name ilike '%optimizers%'
----
49 values hashing to 2b629fd721ba3eba09b5fc3ff5792a27

query T rowsort
explain select name,func from functions where name not ilike '%optimizers%'
----
49 values hashing to b0f4b80d97d5d7d564f01d3e09b0ef53

statement ok
create function contains(str string, substr string)
returns boolean
begin
	  return str like '%'||substr||'%';
end

statement ok
create function not_contains(str string, substr string)
returns boolean
begin
	  return str not like '%'||substr||'%';
end

statement ok
create function icontains(str string, substr string)
returns boolean
begin
	  return str ilike '%'||substr||'%';
end

statement ok
create function not_icontains(str string, substr string)
returns boolean
begin
	  return str not ilike '%'||substr||'%';
end

query T rowsort
explain select name,func from functions where contains(name, 'optimizers')
----
48 values hashing to 32ef3ccf4ef60d2df29fea7d4b0a27d4

query T rowsort
explain select name,func from functions where not_contains(name, 'optimizers')
----
48 values hashing to 00b1293e5516e19ab02424dfcd84bc5f

query T rowsort
explain select name,func from functions where icontains(name, 'optimizers')
----
48 values hashing to 96658d6349c67858d627a6cac4c467e5

query T rowsort
explain select name,func from functions where not_icontains(name, 'optimizers')
----
48 values hashing to 36c0131cc3e60aabd188ed7bd9bdf97a

statement ok
rollback



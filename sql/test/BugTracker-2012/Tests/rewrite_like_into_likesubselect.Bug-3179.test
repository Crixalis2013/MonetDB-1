statement ok
set optimizer='sequential_pipe'

statement ok
start transaction

query T rowsort
explain select name,func from functions where name like '%optimizers%'
----
49 values hashing to d713c0c3af0828e8fea5d727bab227d1

query T rowsort
explain select name,func from functions where name not like '%optimizers%'
----
49 values hashing to b2c935a91fc22ef6a2f353e3d1ea3b5d

query T rowsort
explain select name,func from functions where name ilike '%optimizers%'
----
49 values hashing to 0e429e45d28d24ed3ded17df94b9d0ae

query T rowsort
explain select name,func from functions where name not ilike '%optimizers%'
----
49 values hashing to 135bf4644cf0bf17ee26c24b633860b6

statement ok
create function contains(str string, substr string)
returns boolean
begin
	  return str like '%'||substr||'%';
end

statement ok
create function not_contains(str string, substr string)
returns boolean
begin
	  return str not like '%'||substr||'%';
end

statement ok
create function icontains(str string, substr string)
returns boolean
begin
	  return str ilike '%'||substr||'%';
end

statement ok
create function not_icontains(str string, substr string)
returns boolean
begin
	  return str not ilike '%'||substr||'%';
end

query T rowsort
explain select name,func from functions where contains(name, 'optimizers')
----
48 values hashing to fabc9441a4652a3a1c9106c7e0c3fa1b

query T rowsort
explain select name,func from functions where not_contains(name, 'optimizers')
----
48 values hashing to 522a2218258c852bbf35544c697c7bd6

query T rowsort
explain select name,func from functions where icontains(name, 'optimizers')
----
48 values hashing to ec801ff82084d51f74d37b043498f705

query T rowsort
explain select name,func from functions where not_icontains(name, 'optimizers')
----
48 values hashing to 493330f083173a86623617b4e6527ce3

statement ok
rollback

statement ok
set optimizer='default_pipe'



statement ok
START TRANSACTION

statement ok
create table employees (dep varchar(10), name varchar(20), salary double, hire_date date)

statement ok
insert into employees values
    ('mgmt', 'Smith',81,str_to_date('10-08-2019', '%d-%m-%Y')),
    ('dev', 'Jones',55,str_to_date('9-08-2019', '%d-%m-%Y')),
    ('sls', 'Williams',55,str_to_date('14-07-2019', '%d-%m-%Y')),
    ('sls', 'Taylor',62,str_to_date('13-08-2019', '%d-%m-%Y')),
    ('dev', 'Brown',62,str_to_date('6-06-2019', '%d-%m-%Y')),
    ('mgmt', 'Davies',84,str_to_date('4-06-2019', '%d-%m-%Y')),
    ('sls', 'Evans',87,str_to_date('1-09-2019', '%d-%m-%Y')),
    ('sls', 'Wilson',72,str_to_date('21-09-2019', '%d-%m-%Y')),
    ('sls', 'Thomas',72,str_to_date('12-06-2019', '%d-%m-%Y')),
    ('mgmt', 'Johnson',100,str_to_date('12-07-2019', '%d-%m-%Y'))

query TTRR rowsort
SELECT dep, name, salary, SUM(salary) OVER (ORDER BY EXTRACT(MONTH FROM hire_date)) salary_sum FROM employees
----
40 values hashing to 22382ea2a7aec1038ddd0774f0094575

query TTRR rowsort
SELECT dep, name, salary, SUM(salary) OVER (ORDER BY hire_date) salary_sum FROM employees
----
40 values hashing to daecfc8252e4e476fecce0a99de7f30b

query TTRR rowsort
SELECT dep, name, salary, SUM(salary) OVER (PARTITION BY dep ORDER BY EXTRACT(MONTH FROM hire_date)) salary_sum FROM employees
----
40 values hashing to 49258fedec2df610815083b96126dc0c

statement ok
ROLLBACK



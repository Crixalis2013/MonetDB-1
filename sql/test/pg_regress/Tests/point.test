statement ok
CREATE TABLE POINT_TBL(f1 GEOMETRY(POINT))

statement ok
INSERT INTO POINT_TBL(f1) VALUES (ST_MakePoint(0.0,0.0))

statement ok
INSERT INTO POINT_TBL(f1) VALUES (ST_MakePoint(-10.0,0.0))

statement ok
INSERT INTO POINT_TBL(f1) VALUES (ST_MakePoint(-3.0,4.0))

statement ok
INSERT INTO POINT_TBL(f1) VALUES (ST_MakePoint(5.1, 34.5))

statement ok
INSERT INTO POINT_TBL(f1) VALUES (ST_MakePoint(-5.0,-12.0))

statement ok
INSERT INTO POINT_TBL(f1) VALUES (null)

statement error
INSERT INTO POINT_TBL(f1) VALUES (1.0,2.0)

statement error
INSERT INTO POINT_TBL(f1) VALUES ('asdfasdf')

statement error
INSERT INTO POINT_TBL(f1) VALUES (ST_MakePoint('asdfasdf'))

statement error
INSERT INTO POINT_TBL(f1) VALUES ('10.0,10.0')

statement error
INSERT INTO POINT_TBL(f1) VALUES (ST_MakePoint('10.0,10.0'))

statement error
INSERT INTO POINT_TBL(f1) VALUES ('(10.0 10.0)')

statement error
INSERT INTO POINT_TBL(f1) VALUES (ST_MakePoint(10.0 10.0)))

statement error
INSERT INTO POINT_TBL(f1) VALUES ('(10,0.10,0')

statement error
INSERT INTO POINT_TBL(f1) VALUES (ST_MakePoint(10,0.10,0))

query TT rowsort
SELECT '' AS six, POINT_TBL.* FROM POINT_TBL
----
12 values hashing to a78df031956f873b75a23ca853a5709c

query TTT rowsort
SELECT '' AS six, f1, cast(f1 as varchar(55)) as txt FROM POINT_TBL
----
18 values hashing to c29e43aee4f1e1c470360dd6e0f3b304

statement ok
CREATE VIEW POINT_TBL_VW AS SELECT f1, cast(f1 as varchar(55)) as txt FROM POINT_TBL

query TT rowsort
SELECT * FROM POINT_TBL_VW
----
12 values hashing to 8debc0448944d4450b8a932eb4d46263

query TTT rowsort
SELECT '' AS three, p.* FROM POINT_TBL_VW p WHERE p.f1 << ST_MakePoint(0.0, 0.0)
----
(empty)
POINT (-10 0)
POINT (-10 0)
(empty)
POINT (-3 4)
POINT (-3 4)
(empty)
POINT (-5 -12)
POINT (-5 -12)

query TTT rowsort
SELECT '' AS three, p.* FROM POINT_TBL_VW p WHERE ST_MakePoint(0.0,0.0) >> p.f1
----
(empty)
POINT (-10 0)
POINT (-10 0)
(empty)
POINT (-3 4)
POINT (-3 4)
(empty)
POINT (-5 -12)
POINT (-5 -12)

query TTT rowsort
SELECT '' AS one, p.* FROM POINT_TBL_VW p WHERE ST_MakePoint(0.0,0.0) |>> p.f1
----
(empty)
POINT (-5 -12)
POINT (-5 -12)

query TTT rowsort
SELECT '' AS one, p.* FROM POINT_TBL_VW p WHERE p.f1 <<| ST_MakePoint(0.0, 0.0)
----
(empty)
POINT (-5 -12)
POINT (-5 -12)

query TTT rowsort
SELECT '' AS one, p.* FROM POINT_TBL_VW p WHERE p.f1 ~= ST_MakePoint(5.1, 34.5)
----
(empty)
POINT (5.1 34.5)
POINT (5.1 34.5)

query TTT rowsort
SELECT '' AS three, p.* FROM POINT_TBL_VW p WHERE p.f1 @ ST_WKTToSQL('linestring(0 0, 100 100)')
----
(empty)
POINT (0 0)
POINT (0 0)
(empty)
POINT (5.1 34.5)
POINT (5.1 34.5)

query TTT rowsort
SELECT '' AS three, p.* FROM POINT_TBL_VW p WHERE not p.f1 @ ST_WKTToSQL('linestring(0 0, 100 100)')
----
(empty)
POINT (-10 0)
POINT (-10 0)
(empty)
POINT (-3 4)
POINT (-3 4)
(empty)
POINT (-5 -12)
POINT (-5 -12)

statement error
SELECT '' AS two, p.* FROM POINT_TBL_VW p WHERE p.f1 @ path '[(0,0),(-10,0),(-10,10)]'

query TTR rowsort
SELECT '' AS six, p.f1, p.f1 <-> ST_MakePoint(0,0) AS dist FROM POINT_TBL p ORDER BY dist
----
18 values hashing to 07221559a0854c6f9c459efd16d61c7c

query TTTR rowsort
 
SELECT '' AS thirtysix, p1.f1 AS point1, p2.f1 AS point2, p1.f1 <-> p2.f1 AS dist
   FROM POINT_TBL p1, POINT_TBL p2
   ORDER BY dist, point1, point2
----
144 values hashing to 71b25742546387aa4fc9cefea71189a8

query TTT rowsort
SELECT '' AS twenty, p1.f1 AS point1, p2.f1 AS point2 FROM POINT_TBL p1, POINT_TBL p2 WHERE (p1.f1 <-> p2.f1) > 3
----
60 values hashing to bd811487c45a55adfac3516ed3fb60b9

query TTTR rowsort
SELECT '' AS ten, p1.f1 AS point1, p2.f1 AS point2, (p1.f1 <-> p2.f1) AS distance
   FROM POINT_TBL p1, POINT_TBL p2
   WHERE (p1.f1 <-> p2.f1) > 3 and p1.f1 << p2.f1
   ORDER BY distance, point1, point2
----
40 values hashing to 254270cd11f24ced27d9f4023d80a5e9

query TTTR rowsort
SELECT '' AS ten, p1.f1 AS point1, p2.f1 AS point2, (p1.f1 <-> p2.f1) AS distance
   FROM POINT_TBL p1, POINT_TBL p2
   WHERE (p1.f1 <-> p2.f1) > 3 and p1.f1 << p2.f1
   ORDER BY distance, point1
----
40 values hashing to 254270cd11f24ced27d9f4023d80a5e9

statement ok
 
DROP VIEW POINT_TBL_VW

statement ok
DROP TABLE POINT_TBL



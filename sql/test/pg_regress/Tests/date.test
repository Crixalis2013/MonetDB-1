statement ok
CREATE TABLE DATE_TBL (f1 date)

statement ok
INSERT INTO DATE_TBL VALUES ('1957-04-09')

statement ok
INSERT INTO DATE_TBL VALUES ('1957-06-13')

statement ok
INSERT INTO DATE_TBL VALUES ('1996-02-28')

statement ok
INSERT INTO DATE_TBL VALUES ('1996-02-29')

statement ok
INSERT INTO DATE_TBL VALUES ('1996-03-01')

statement ok
INSERT INTO DATE_TBL VALUES ('1996-03-02')

statement ok
INSERT INTO DATE_TBL VALUES ('1997-02-28')

statement error
INSERT INTO DATE_TBL VALUES ('1997-02-29')

statement ok
INSERT INTO DATE_TBL VALUES ('1997-03-01')

statement ok
INSERT INTO DATE_TBL VALUES ('1997-03-02')

statement ok
INSERT INTO DATE_TBL VALUES ('2000-04-01')

statement ok
INSERT INTO DATE_TBL VALUES ('2000-04-02')

statement ok
INSERT INTO DATE_TBL VALUES ('2000-04-03')

statement ok
INSERT INTO DATE_TBL VALUES ('2038-04-08')

statement ok
INSERT INTO DATE_TBL VALUES ('2039-04-09')

statement ok
INSERT INTO DATE_TBL VALUES ('2040-04-10')

query T rowsort
SELECT f1 AS "Fifteen" FROM DATE_TBL
----
15 values hashing to 374c022dfae66832cfca664bf971fe76

query T rowsort
SELECT f1 AS "Nine" FROM DATE_TBL WHERE f1 < '2000-01-01'
----
1957-04-09
1957-06-13
1996-02-28
1996-02-29
1996-03-01
1996-03-02
1997-02-28
1997-03-01
1997-03-02

query T rowsort
SELECT f1 AS "Three" FROM DATE_TBL
  WHERE f1 BETWEEN '2000-01-01' AND '2001-01-01'
----
2000-04-01
2000-04-02
2000-04-03

statement ok
INSERT INTO DATE_TBL VALUES (null)

statement error
SELECT f1, day(f1) FROM DATE_TBL

query TI rowsort
SELECT f1, "day"(f1) FROM DATE_TBL
----
32 values hashing to a322b7c7950855bf240776aae80117d3

statement error
SELECT f1, month(f1) FROM DATE_TBL

query TI rowsort
SELECT f1, "month"(f1) FROM DATE_TBL
----
32 values hashing to 41bd859b58a99f37d3d564541dd1b8a4

statement error
SELECT f1, year(f1) FROM DATE_TBL

query TI rowsort
SELECT f1, "year"(f1) FROM DATE_TBL
----
32 values hashing to 11bd50e371a210aba8e2d31c157173f8

query TI rowsort
SELECT f1, extract(day from f1) FROM DATE_TBL
----
32 values hashing to a322b7c7950855bf240776aae80117d3

query TI rowsort
SELECT f1, extract(week from f1) FROM DATE_TBL
----
32 values hashing to 15611b1d0cd6f9e1c46357800cd58ae5

query TI rowsort
SELECT f1, extract(month from f1) FROM DATE_TBL
----
32 values hashing to 41bd859b58a99f37d3d564541dd1b8a4

query TI rowsort
SELECT f1, extract(quarter from f1) FROM DATE_TBL
----
32 values hashing to dba0f7097bf25140a7ff925a33dae4ff

statement error
SELECT f1, extract(halfyear from f1) FROM DATE_TBL

query TI rowsort
SELECT f1, extract(year from f1) FROM DATE_TBL
----
32 values hashing to 11bd50e371a210aba8e2d31c157173f8

query TI rowsort
SELECT f1, extract(century from f1) FROM DATE_TBL
----
32 values hashing to 8b585bfa40596f181c92c94446f10da7

statement error
SELECT f1, extract(millennium from f1) FROM DATE_TBL

query TI rowsort
SELECT f1, extract(epoch from f1) FROM DATE_TBL
----
32 values hashing to b7ee0d94f5dfd2de6d7ea757f0321b28

query TI rowsort
SELECT f1, week(f1) FROM DATE_TBL
----
32 values hashing to 15611b1d0cd6f9e1c46357800cd58ae5

query TI rowsort
SELECT f1, weekofyear(f1) FROM DATE_TBL
----
32 values hashing to 15611b1d0cd6f9e1c46357800cd58ae5

query TI rowsort
SELECT f1, dayofmonth(f1) FROM DATE_TBL
----
32 values hashing to a322b7c7950855bf240776aae80117d3

query TI rowsort
SELECT f1, dayofweek(f1) FROM DATE_TBL
----
32 values hashing to 6f3b0a6b79e2687f4e13b9c4ac6fc2ba

query TI rowsort
SELECT f1, dayofyear(f1) FROM DATE_TBL
----
32 values hashing to 7c465a1609a07edf4d62c3af81cab002

statement error
SELECT f1, hour(f1) FROM DATE_TBL

query TI rowsort
SELECT f1, "hour"(f1) FROM DATE_TBL
----
32 values hashing to c69f171cef9937059a0d7f730d0cb5bb

statement error
SELECT f1, minute(f1) FROM DATE_TBL

query TI rowsort
SELECT f1, "minute"(f1) FROM DATE_TBL
----
32 values hashing to c69f171cef9937059a0d7f730d0cb5bb

statement error
SELECT f1, second(f1) FROM DATE_TBL

query TR rowsort
SELECT f1, "second"(f1) FROM DATE_TBL
----
32 values hashing to 418df9efc27b77e5b5c1877834dd6fb8

query TI rowsort
SELECT f1, extract(hour from f1) FROM DATE_TBL
----
32 values hashing to c69f171cef9937059a0d7f730d0cb5bb

query TI rowsort
SELECT f1, extract(minute from f1) FROM DATE_TBL
----
32 values hashing to c69f171cef9937059a0d7f730d0cb5bb

query TR rowsort
SELECT f1, extract(second from f1) FROM DATE_TBL
----
32 values hashing to 418df9efc27b77e5b5c1877834dd6fb8

query TT rowsort
SELECT f1, cast(f1 as timestamp) FROM DATE_TBL
----
32 values hashing to e307af9fa5f8586250b9fa8ec11c4a2b

statement error
SELECT f1, hour(cast(f1 as timestamp)) FROM DATE_TBL

query TI rowsort
SELECT f1, "hour"(cast(f1 as timestamp)) FROM DATE_TBL
----
32 values hashing to c69f171cef9937059a0d7f730d0cb5bb

statement error
SELECT f1, minute(cast(f1 as timestamp)) FROM DATE_TBL

query TI rowsort
SELECT f1, "minute"(cast(f1 as timestamp)) FROM DATE_TBL
----
32 values hashing to c69f171cef9937059a0d7f730d0cb5bb

statement error
SELECT f1, second(cast(f1 as timestamp)) FROM DATE_TBL

query TR rowsort
SELECT f1, "second"(cast(f1 as timestamp)) FROM DATE_TBL
----
32 values hashing to 418df9efc27b77e5b5c1877834dd6fb8

query TI rowsort
SELECT f1, extract(hour from cast(f1 as timestamp)) FROM DATE_TBL
----
32 values hashing to c69f171cef9937059a0d7f730d0cb5bb

query TI rowsort
SELECT f1, extract(minute from cast(f1 as timestamp)) FROM DATE_TBL
----
32 values hashing to c69f171cef9937059a0d7f730d0cb5bb

query TR rowsort
SELECT f1, extract(second from cast(f1 as timestamp)) FROM DATE_TBL
----
32 values hashing to 418df9efc27b77e5b5c1877834dd6fb8

statement error
SELECT f1, sql_add(f1, 365*24*60*60.0) FROM DATE_TBL

statement error
SELECT f1, sql_add(f1, cast(365*24*60*60 as interval second)) FROM DATE_TBL

statement error
SELECT f1, sql_add(f1, cast(12 as interval month)) FROM DATE_TBL

statement error
SELECT f1, sql_add(f1, cast(-18 as interval month)) FROM DATE_TBL

statement error
SELECT f1, sql_sub(f1, 365*24*60*60.0) FROM DATE_TBL

statement error
SELECT f1, sql_sub(f1, cast(365*24*60*60 as interval second)) FROM DATE_TBL

statement error
SELECT f1, sql_sub(f1, cast(12 as interval month)) FROM DATE_TBL

statement error
SELECT f1, sql_sub(f1, cast(-18 as interval month)) FROM DATE_TBL

query T rowsort
SELECT f1, sql_sub(f1, cast('2001-12-12' as date)) FROM DATE_TBL
----
32 values hashing to 418df9efc27b77e5b5c1877834dd6fb8

query T rowsort
SELECT f1, sql_sub(cast('2001-12-12' as date), f1) FROM DATE_TBL
----
32 values hashing to 418df9efc27b77e5b5c1877834dd6fb8

query T rowsort
SELECT date 'January 8, 1999'
----
1999-01-08

query T rowsort
SELECT date '1999-01-08'
----
1999-01-08

query T rowsort
SELECT date '1999-01-18'
----
1999-01-18

statement error
SELECT date '1/8/1999'

statement error
SELECT date '1/18/1999'

statement error
SELECT date '18/1/1999'

statement error
SELECT date '01/02/03'

statement error
SELECT date '19990108'

statement error
SELECT date '990108'

statement error
SELECT date '1999.008'

statement error
SELECT date 'J2451187'

statement error
SELECT date 'January 8, 99 BC'

statement error
SELECT date '99-Jan-08'

query T rowsort
SELECT date '1999-Jan-08'
----
1999-01-08

statement error
SELECT date '08-Jan-99'

statement error
SELECT date '08-Jan-1999'

statement error
SELECT date 'Jan-08-99'

statement error
SELECT date 'Jan-08-1999'

statement error
SELECT date '99-08-Jan'

statement error
SELECT date '1999-08-Jan'

statement error
SELECT date '99 Jan 08'

query T rowsort
SELECT date '1999 Jan 08'
----
1999-01-08

statement error
SELECT date '08 Jan 99'

statement error
SELECT date '08 Jan 1999'

statement error
SELECT date 'Jan 08 99'

query T rowsort
SELECT date 'Jan 08 1999'
----
1999-01-08

statement error
SELECT date '99 08 Jan'

statement error
SELECT date '1999 08 Jan'

statement error
SELECT date '99-01-08'

query T rowsort
SELECT date '1999-01-08'
----
1999-01-08

statement error
SELECT date '08-01-99'

statement error
SELECT date '08-01-1999'

statement error
SELECT date '01-08-99'

statement error
SELECT date '01-08-1999'

statement error
SELECT date '99-08-01'

query T rowsort
SELECT date '1999-08-01'
----
1999-08-01

statement error
SELECT date '99 01 08'

query T rowsort
SELECT date '1999 01 08'
----
1999-01-08

statement error
SELECT date '08 01 99'

statement error
SELECT date '08 01 1999'

statement error
SELECT date '01 08 99'

statement error
SELECT date '01 08 1999'

statement error
SELECT date '99 08 01'

query T rowsort
SELECT date '1999 08 01'
----
1999-08-01

query T rowsort
 
SELECT date 'January 8, 1999'
----
1999-01-08

query T rowsort
SELECT date '1999-01-08'
----
1999-01-08

query T rowsort
SELECT date '1999-01-18'
----
1999-01-18

statement error
SELECT date '1/8/1999'

statement error
SELECT date '1/18/1999'

statement error
SELECT date '18/1/1999'

statement error
SELECT date '01/02/03'

statement error
SELECT date '19990108'

statement error
SELECT date '990108'

statement error
SELECT date '1999.008'

statement error
SELECT date 'J2451187'

statement error
SELECT date 'January 8, 99 BC'

statement error
SELECT date '99-Jan-08'

query T rowsort
SELECT date '1999-Jan-08'
----
1999-01-08

statement error
SELECT date '08-Jan-99'

statement error
SELECT date '08-Jan-1999'

statement error
SELECT date 'Jan-08-99'

statement error
SELECT date 'Jan-08-1999'

statement error
SELECT date '99-08-Jan'

statement error
SELECT date '1999-08-Jan'

statement error
SELECT date '99 Jan 08'

query T rowsort
SELECT date '1999 Jan 08'
----
1999-01-08

statement error
SELECT date '08 Jan 99'

statement error
SELECT date '08 Jan 1999'

statement error
SELECT date 'Jan 08 99'

query T rowsort
SELECT date 'Jan 08 1999'
----
1999-01-08

statement error
SELECT date '99 08 Jan'

statement error
SELECT date '1999 08 Jan'

statement error
SELECT date '99-01-08'

query T rowsort
SELECT date '1999-01-08'
----
1999-01-08

statement error
SELECT date '08-01-99'

statement error
SELECT date '08-01-1999'

statement error
SELECT date '01-08-99'

statement error
SELECT date '01-08-1999'

statement error
SELECT date '99-08-01'

query T rowsort
SELECT date '1999-08-01'
----
1999-08-01

statement error
SELECT date '99 01 08'

query T rowsort
SELECT date '1999 01 08'
----
1999-01-08

statement error
SELECT date '08 01 99'

statement error
SELECT date '08 01 1999'

statement error
SELECT date '01 08 99'

statement error
SELECT date '01 08 1999'

statement error
SELECT date '99 08 01'

query T rowsort
SELECT date '1999 08 01'
----
1999-08-01

query T rowsort
 
SELECT date 'January 8, 1999'
----
1999-01-08

query T rowsort
SELECT date '1999-01-08'
----
1999-01-08

query T rowsort
SELECT date '1999-01-18'
----
1999-01-18

statement error
SELECT date '1/8/1999'

statement error
SELECT date '1/18/1999'

statement error
SELECT date '18/1/1999'

statement error
SELECT date '01/02/03'

statement error
SELECT date '19990108'

statement error
SELECT date '990108'

statement error
SELECT date '1999.008'

statement error
SELECT date 'J2451187'

statement error
SELECT date 'January 8, 99 BC'

statement error
SELECT date '99-Jan-08'

query T rowsort
SELECT date '1999-Jan-08'
----
1999-01-08

statement error
SELECT date '08-Jan-99'

statement error
SELECT date '08-Jan-1999'

statement error
SELECT date 'Jan-08-99'

statement error
SELECT date 'Jan-08-1999'

statement error
SELECT date '99-08-Jan'

statement error
SELECT date '1999-08-Jan'

statement error
SELECT date '99 Jan 08'

query T rowsort
SELECT date '1999 Jan 08'
----
1999-01-08

statement error
SELECT date '08 Jan 99'

statement error
SELECT date '08 Jan 1999'

statement error
SELECT date 'Jan 08 99'

query T rowsort
SELECT date 'Jan 08 1999'
----
1999-01-08

statement error
SELECT date '99 08 Jan'

statement error
SELECT date '1999 08 Jan'

statement error
SELECT date '99-01-08'

query T rowsort
SELECT date '1999-01-08'
----
1999-01-08

statement error
SELECT date '08-01-99'

statement error
SELECT date '08-01-1999'

statement error
SELECT date '01-08-99'

statement error
SELECT date '01-08-1999'

statement error
SELECT date '99-08-01'

query T rowsort
SELECT date '1999-08-01'
----
1999-08-01

statement error
SELECT date '99 01 08'

query T rowsort
SELECT date '1999 01 08'
----
1999-01-08

statement error
SELECT date '08 01 99'

statement error
SELECT date '08 01 1999'

statement error
SELECT date '01 08 99'

statement error
SELECT date '01 08 1999'

statement error
SELECT date '99 08 01'

query T rowsort
SELECT date '1999 08 01'
----
1999-08-01

query T rowsort
SELECT f1 - date '2000-01-01' AS "Days From 2K" FROM DATE_TBL
----
16 values hashing to 418df9efc27b77e5b5c1877834dd6fb8

statement error
SELECT f1 - date 'epoch' AS "Days From Epoch" FROM DATE_TBL

statement error
SELECT sql_sub(current_date, 24*60*60.0) - current_date AS "One day"

statement error
SELECT current_date - sql_add(current_date, 24*60*60.0) AS "One day"

statement error
SELECT sql_sub(current_date, 24*60*60.0) - sql_add(current_date, 24*60*60.0) AS "Two days"

statement error
SELECT sql_add(current_date, 24*60*60.0) - current_date AS "One day"

statement error
SELECT current_date - sql_sub(current_date, 24*60*60.0) AS "One day"

statement error
SELECT sql_add(current_date, 24*60*60.0) - sql_sub(current_date, 24*60*60.0) AS "Two days"

query I rowsort
SELECT EXTRACT(CENTURY FROM DATE '0101-12-31 BC')
----
2

query I rowsort
SELECT EXTRACT(CENTURY FROM DATE '0100-12-31 BC')
----
1

query I rowsort
SELECT EXTRACT(CENTURY FROM DATE '0001-12-31 BC')
----
1

query I rowsort
SELECT EXTRACT(CENTURY FROM DATE '0001-01-01')
----
1

query I rowsort
SELECT EXTRACT(CENTURY FROM DATE '0001-01-01 AD')
----
1

query I rowsort
SELECT EXTRACT(CENTURY FROM DATE '1900-12-31')
----
19

query I rowsort
SELECT EXTRACT(CENTURY FROM DATE '1901-01-01')
----
20

query I rowsort
SELECT EXTRACT(CENTURY FROM DATE '2000-12-31')
----
20

query I rowsort
SELECT EXTRACT(CENTURY FROM DATE '2001-01-01')
----
21

statement error
SELECT EXTRACT(CENTURY FROM CURRENT_DATE)>=21 AS True

statement error
SELECT EXTRACT(MILLENNIUM FROM DATE '0001-12-31 BC')

statement error
SELECT EXTRACT(MILLENNIUM FROM DATE '0001-01-01 AD')

statement error
SELECT EXTRACT(MILLENNIUM FROM DATE '1000-12-31')

statement error
SELECT EXTRACT(MILLENNIUM FROM DATE '1001-01-01')

statement error
SELECT EXTRACT(MILLENNIUM FROM DATE '2000-12-31')

statement error
SELECT EXTRACT(MILLENNIUM FROM DATE '2001-01-01')

statement error
SELECT EXTRACT(MILLENNIUM FROM CURRENT_DATE)

query I rowsort
SELECT EXTRACT(DECADE FROM DATE '1994-12-25')
----
199

query I rowsort
SELECT EXTRACT(DECADE FROM DATE '0010-01-01')
----
1

query I rowsort
SELECT EXTRACT(DECADE FROM DATE '0009-12-31')
----
0

query I rowsort
SELECT EXTRACT(DECADE FROM DATE '0001-01-01 BC')
----
0

query I rowsort
SELECT EXTRACT(DECADE FROM DATE '0002-12-31 BC')
----
0

query I rowsort
SELECT EXTRACT(DECADE FROM DATE '0011-01-01 BC')
----
1

query I rowsort
SELECT EXTRACT(DECADE FROM DATE '0012-12-31 BC')
----
1

statement error
SELECT EXTRACT(CENTURY FROM NOW())>=21 AS True

query I rowsort
SELECT EXTRACT(CENTURY FROM TIMESTAMP '1970-03-20 04:30:00.00000')
----
20

statement error
SELECT EXTRACT(CENTURY FROM INTERVAL '100 y')

statement error
SELECT EXTRACT(CENTURY FROM INTERVAL '99 y')

statement error
SELECT EXTRACT(CENTURY FROM INTERVAL '-99 y')

statement error
SELECT EXTRACT(CENTURY FROM INTERVAL '-100 y')

query T rowsort
SELECT DATE_TRUNC('MILLENNIUM', TIMESTAMP '1970-03-20 04:30:00.00000')
----
1000-01-01 00:00:00

query T rowsort
SELECT DATE_TRUNC('MILLENNIUM', DATE '1970-03-20')
----
1000-01-01 00:00:00

query T rowsort
SELECT DATE_TRUNC('CENTURY', TIMESTAMP '1970-03-20 04:30:00.00000')
----
1900-01-01 00:00:00

query T rowsort
SELECT DATE_TRUNC('CENTURY', DATE '1970-03-20')
----
1900-01-01 00:00:00

query T rowsort
SELECT DATE_TRUNC('CENTURY', DATE '2004-08-10')
----
2000-01-01 00:00:00

statement error
SELECT DATE_TRUNC('CENTURY', DATE '0002-02-04')

statement error
SELECT DATE_TRUNC('CENTURY', DATE '0055-08-10 BC')

query T rowsort
SELECT DATE_TRUNC('DECADE', DATE '1993-12-25')
----
1990-01-01 00:00:00

statement error
SELECT DATE_TRUNC('DECADE', DATE '0004-12-25')

statement error
SELECT DATE_TRUNC('DECADE', DATE '0002-12-31 BC')

statement ok
DROP TABLE DATE_TBL



statement ok
create schema test

statement ok
create table test.share_daily_history (id string, timeid int, c1 int, c2 int, c3 int, c4 int, volume int)

query  rowsort
prepare merge into test.share_daily_history as target
using (select * from (values('BHP',1,1 ,1 ,1 ,1 ,1)) as a(id,timeid,c1,c2,c3,c4,volume)) as source
on source.id=target.id and source.timeid=target.timeid
when not matched then insert (id,timeid,c1,c2,c3,c4,volume) values(source.id,source.timeid,source.c1,source.c2,source.c3,source.c4,source.volume)
----

statement ok
exec **()

statement ok
exec **()

statement ok
prepare merge into test.share_daily_history as target
using (select * from (values('BHP',?,?,?,?,?,?)) as a(id,timeid,c1,c2,c3,c4,volume)) as source
on source.id=target.id and source.timeid=target.timeid
when not matched then insert (id,timeid,c1,c2,c3,c4,volume) values(source.id,source.timeid,source.c1,source.c2,source.c3,source.c4,source.volume)

statement ok
exec **(1,2,3,4,5,6)

statement error
prepare select * from test.share_daily_history
inner join (values('BHP',?,?,?,?,?,?)) as source(id,timeid,c1,c2,c3,c4,volume)
on source.id=share_daily_history.id and source.timeid=share_daily_history.timeid; --error

statement ok
prepare select * from test.share_daily_history inner join (values('BHP',?)) as source(id,timeid)
on source.id=share_daily_history.id and source.timeid=share_daily_history.timeid

statement error
exec **()

statement ok
prepare select * from test.share_daily_history
inner join (values('BHP')) as source(id)
on source.id=share_daily_history.id

statement error
exec **(1)

statement ok
prepare select * from test.share_daily_history
inner join (values(?), ('BHP')) as source(id)
on source.id=share_daily_history.id

statement ok
exec **('a')

statement ok
prepare select * from test.share_daily_history
inner join (values('BHP'), (?)) as source(id)
on source.id=share_daily_history.id

statement ok
exec **('a')

statement ok
prepare select * from test.share_daily_history
inner join (values(?)) as source(id)
on source.id=share_daily_history.id

statement ok
exec **('a')

statement ok
prepare select * from test.share_daily_history
inner join (values(?),(?),(?)) as source(id)
on source.id=share_daily_history.id

statement ok
exec **('a','b','c')

statement ok
drop schema test cascade



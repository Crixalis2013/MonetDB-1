statement ok
start transaction

statement ok
create table analytics (aa int, bb int)

statement ok
insert into analytics values (15, 3), (3, 1), (2, 1), (5, 3), (NULL, 2), (3, 2), (4, 1), (6, 3), (8, 2), (NULL, 4)

query RRRR rowsort
select covar_samp(aa, aa) over (partition by bb),
       covar_samp(aa, aa) over (partition by bb order by bb asc),
       covar_samp(aa, aa) over (partition by bb order by bb desc),
       covar_samp(aa, aa) over (order by bb desc) from analytics
----
40 values hashing to c5eaba4ec47f12cef293d5277c7abadc

query RRRR rowsort
select covar_samp(bb, bb) over (partition by bb),
       covar_samp(bb, bb) over (partition by bb order by bb asc),
       covar_samp(bb, bb) over (partition by bb order by bb desc),
       covar_samp(bb, bb) over (order by bb desc) from analytics
----
40 values hashing to ae6beaca3c3b4985a3dbc6912078a544

query RRRR rowsort
select corr(bb, bb) over (partition by bb),
       corr(bb, bb) over (partition by bb order by bb asc),
       corr(bb, bb) over (partition by bb order by bb desc),
       corr(bb, bb) over (order by bb desc) from analytics
----
40 values hashing to 1189ddcf42d5f17e6cc2d8d1ff775fc5

query RRRR rowsort
select covar_pop(aa, aa) over (partition by bb),
       covar_pop(aa, aa) over (partition by bb order by bb asc),
       covar_pop(aa, aa) over (partition by bb order by bb desc),
       covar_pop(aa, aa) over (order by bb desc) from analytics
----
40 values hashing to 0fa0a58d04c1d7d4c5d5b515053a91ce

query RRRR rowsort
select covar_pop(bb, bb) over (partition by bb),
       covar_pop(bb, bb) over (partition by bb order by bb asc),
       covar_pop(bb, bb) over (partition by bb order by bb desc),
       covar_pop(bb, bb) over (order by bb desc) from analytics
----
40 values hashing to fd7b83599b0b51fc80d01c6852f415e8

query RRRR rowsort
select corr(bb, bb) over (partition by bb),
       corr(bb, bb) over (partition by bb order by bb asc),
       corr(bb, bb) over (partition by bb order by bb desc),
       corr(bb, bb) over (order by bb desc) from analytics
----
40 values hashing to 1189ddcf42d5f17e6cc2d8d1ff775fc5

query RRRR rowsort
select covar_samp(aa, bb) over (partition by bb),
       covar_samp(aa, bb) over (partition by bb order by bb asc),
       covar_samp(aa, bb) over (partition by bb order by bb desc),
       covar_samp(aa, bb) over (order by bb desc) from analytics
----
40 values hashing to be4bd2f012a1d563ebac580e5a8ca673

query RRRR rowsort
select covar_samp(bb, aa) over (partition by bb),
       covar_samp(bb, aa) over (partition by bb order by bb asc),
       covar_samp(bb, aa) over (partition by bb order by bb desc),
       covar_samp(bb, aa) over (order by bb desc) from analytics
----
40 values hashing to be4bd2f012a1d563ebac580e5a8ca673

query RRRR rowsort
select corr(bb, aa) over (partition by bb),
       corr(bb, aa) over (partition by bb order by bb asc),
       corr(bb, aa) over (partition by bb order by bb desc),
       corr(bb, aa) over (order by bb desc) from analytics
----
40 values hashing to c619075e7be2da64dbf1e9e73d429b82

query RRRR rowsort
select covar_pop(aa, bb) over (partition by bb),
       covar_pop(aa, bb) over (partition by bb order by bb asc),
       covar_pop(aa, bb) over (partition by bb order by bb desc),
       covar_pop(aa, bb) over (order by bb desc) from analytics
----
40 values hashing to 02ad98d6e68eb363b37e554de98e7c10

query RRRR rowsort
select covar_pop(bb, aa) over (partition by bb),
       covar_pop(bb, aa) over (partition by bb order by bb asc),
       covar_pop(bb, aa) over (partition by bb order by bb desc),
       covar_pop(bb, aa) over (order by bb desc) from analytics
----
40 values hashing to 02ad98d6e68eb363b37e554de98e7c10

query RRRR rowsort
select corr(bb, aa) over (partition by bb),
       corr(bb, aa) over (partition by bb order by bb asc),
       corr(bb, aa) over (partition by bb order by bb desc),
       corr(bb, aa) over (order by bb desc) from analytics
----
40 values hashing to c619075e7be2da64dbf1e9e73d429b82

query RRRR rowsort
select covar_pop(aa, 1) over (partition by bb),
       covar_pop(aa, 1) over (partition by bb order by bb asc),
       covar_pop(aa, 1) over (partition by bb order by bb desc),
       covar_pop(aa, 1) over (order by bb desc) from analytics
----
40 values hashing to 901ab47bba1dd5c262cd9f430635e03d

query RRRR rowsort
select covar_pop(bb, -100) over (partition by bb),
       covar_pop(bb, -100) over (partition by bb order by bb asc),
       covar_pop(bb, -100) over (partition by bb order by bb desc),
       covar_pop(bb, -100) over (order by bb desc) from analytics
----
40 values hashing to b88c94cc99d64fcd94941093d32e317e

query RRRR rowsort
select corr(bb, -100) over (partition by bb),
       corr(bb, -100) over (partition by bb order by bb asc),
       corr(bb, -100) over (partition by bb order by bb desc),
       corr(bb, -100) over (order by bb desc) from analytics
----
40 values hashing to c592fdbc473c6ef69c4747110455fb4a

query RRRR rowsort
select covar_samp(aa, 1) over (partition by bb),
       covar_samp(aa, 1) over (partition by bb order by bb asc),
       covar_samp(aa, 1) over (partition by bb order by bb desc),
       covar_samp(aa, 1) over (order by bb desc) from analytics
----
40 values hashing to 901ab47bba1dd5c262cd9f430635e03d

query RRRR rowsort
select covar_samp(bb, -100) over (partition by bb),
       covar_samp(bb, -100) over (partition by bb order by bb asc),
       covar_samp(bb, -100) over (partition by bb order by bb desc),
       covar_samp(bb, -100) over (order by bb desc) from analytics
----
40 values hashing to 901ab47bba1dd5c262cd9f430635e03d

query RRRR rowsort
select corr(bb, -100) over (partition by bb),
       corr(bb, -100) over (partition by bb order by bb asc),
       corr(bb, -100) over (partition by bb order by bb desc),
       corr(bb, -100) over (order by bb desc) from analytics
----
40 values hashing to c592fdbc473c6ef69c4747110455fb4a

query RRRRRR rowsort
select covar_pop(aa, aa) over (),
       covar_pop(bb, bb) over (),
       covar_pop(aa, bb) over (),
       covar_pop(bb, aa) over (),
       covar_pop(aa, 1) over (),
       covar_pop(aa, 1) over () from analytics
----
60 values hashing to 1f0e8d1af73c69df669a35d036df088f

query RRRRRR rowsort
select covar_samp(aa, aa) over (),
       covar_samp(bb, bb) over (),
       covar_samp(aa, bb) over (),
       covar_samp(bb, aa) over (),
       covar_samp(aa, 1) over (),
       covar_samp(bb, -100) over () from analytics
----
60 values hashing to ebfb79cb5023de2db00c382c87357102

query RRRRRR rowsort
select corr(aa, aa) over (),
       corr(bb, bb) over (),
       corr(aa, bb) over (),
       corr(bb, aa) over (),
       corr(aa, 1) over (),
       corr(bb, -100) over () from analytics
----
60 values hashing to 15d35d0e916e42231b07284e68b863c9

query RRRRR rowsort
select covar_samp(NULL, 2) over (),
       covar_samp(2, NULL) over (),
       covar_samp(aa, NULL) over (),
       covar_samp(NULL, aa) over (),
       covar_samp(NULL, NULL) over () from analytics
----
50 values hashing to f8fbfb8cccbfe29c3f00ccd6ae9c19e3

query RRRRR rowsort
select covar_pop(NULL, 2) over (),
       covar_pop(2, NULL) over (),
       covar_pop(aa, NULL) over (),
       covar_pop(NULL, aa) over (),
       covar_pop(NULL, NULL) over () from analytics
----
50 values hashing to f8fbfb8cccbfe29c3f00ccd6ae9c19e3

query RRRRR rowsort
select corr(NULL, 2) over (),
       corr(2, NULL) over (),
       corr(aa, NULL) over (),
       corr(NULL, aa) over (),
       corr(NULL, NULL) over () from analytics
----
50 values hashing to f8fbfb8cccbfe29c3f00ccd6ae9c19e3

query RRRRRR rowsort
select covar_pop(1,1) over (), covar_samp(1,1) over (), corr(1,1) over (), covar_pop(1,null) over (), covar_samp(1,null) over (), corr(1,null) over ()
----
0.000
NULL
NULL
NULL
NULL
NULL

query RRRRRR rowsort
select covar_pop(1,1) over (), covar_samp(1,1) over (), corr(1,1) over (), covar_pop(1,null) over (), covar_samp(1,null) over (), corr(1,null) over () from analytics
----
60 values hashing to f90e3786a569c718547b210867a1ce8d

statement ok
rollback


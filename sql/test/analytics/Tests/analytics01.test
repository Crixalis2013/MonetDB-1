statement ok
create table analytics (aa int, bb int, cc bigint)

statement ok
insert into analytics values (15, 3, 15), (3, 1, 3), (2, 1, 2), (5, 3, 5), (NULL, 2, NULL), (3, 2, 3), (4, 1, 4), (6, 3, 6), (8, 2, 8), (NULL, 4, NULL)

statement ok
start transaction

query R rowsort
select percent_rank() over (partition by aa) from analytics
----
10 values hashing to 5395eb5827c9cdfa042cd5e47d31da11

query R rowsort
select percent_rank() over (partition by aa order by aa asc) from analytics
----
10 values hashing to 5395eb5827c9cdfa042cd5e47d31da11

query R rowsort
select percent_rank() over (partition by aa order by aa desc) from analytics
----
10 values hashing to 5395eb5827c9cdfa042cd5e47d31da11

query R rowsort
select percent_rank() over (order by aa) from analytics
----
10 values hashing to ead655a38c62fcec079dfc00dda9e341

query R rowsort
select percent_rank() over (order by aa desc) from analytics
----
10 values hashing to 8a1e4797d2802b2efd9408edff16da67

query R rowsort
select percent_rank() over (partition by bb) from analytics
----
10 values hashing to 5395eb5827c9cdfa042cd5e47d31da11

query R rowsort
select percent_rank() over (partition by bb order by bb asc) from analytics
----
10 values hashing to 5395eb5827c9cdfa042cd5e47d31da11

query R rowsort
select percent_rank() over (partition by bb order by bb desc) from analytics
----
10 values hashing to 5395eb5827c9cdfa042cd5e47d31da11

query R rowsort
select percent_rank() over (order by bb) from analytics
----
10 values hashing to c1b62ad233a780051ab99567d7c76223

query R rowsort
select percent_rank() over (order by bb desc) from analytics
----
10 values hashing to 8b454877d9242885a71822575efe15f3

query R rowsort
select cume_dist() over (partition by aa) from analytics
----
10 values hashing to 6b30ac6cf647148cb343fab8333da947

query R rowsort
select cume_dist() over (partition by aa order by aa asc) from analytics
----
10 values hashing to 6b30ac6cf647148cb343fab8333da947

query R rowsort
select cume_dist() over (partition by aa order by aa desc) from analytics
----
10 values hashing to 6b30ac6cf647148cb343fab8333da947

query R rowsort
select cume_dist() over (order by aa) from analytics
----
10 values hashing to 0430c4043b57d3926605ca12c6e96a5f

query R rowsort
select cume_dist() over (order by aa desc) from analytics
----
10 values hashing to 10ad2ad13838551377eed2a095611933

query R rowsort
select cume_dist() over (partition by bb) from analytics
----
10 values hashing to 6b30ac6cf647148cb343fab8333da947

query R rowsort
select cume_dist() over (partition by bb order by bb asc) from analytics
----
10 values hashing to 6b30ac6cf647148cb343fab8333da947

query R rowsort
select cume_dist() over (partition by bb order by bb desc) from analytics
----
10 values hashing to 6b30ac6cf647148cb343fab8333da947

query R rowsort
select cume_dist() over (order by bb) from analytics
----
10 values hashing to 58c74bc4b92fee6f87b7039c349fb4fc

query R rowsort
select cume_dist() over (order by bb desc) from analytics
----
10 values hashing to 329910a722e44f2afe11a20343723900

query I rowsort
select ntile(1) over (partition by aa) from analytics
----
10 values hashing to eabdbd29c5918a1ebe3bdb572dcae04a

query I rowsort
select ntile(1) over (partition by aa order by aa asc) from analytics
----
10 values hashing to eabdbd29c5918a1ebe3bdb572dcae04a

query I rowsort
select ntile(1) over (partition by aa order by aa desc) from analytics
----
10 values hashing to eabdbd29c5918a1ebe3bdb572dcae04a

query I rowsort
select ntile(1) over (order by aa) from analytics
----
10 values hashing to eabdbd29c5918a1ebe3bdb572dcae04a

query I rowsort
select ntile(1) over (order by aa desc) from analytics
----
10 values hashing to eabdbd29c5918a1ebe3bdb572dcae04a

query I rowsort
select ntile(3) over (partition by bb) from analytics
----
10 values hashing to 54697bf57ed23745baffa3ed44db8764

query I rowsort
select ntile(3) over (partition by bb order by bb asc) from analytics
----
10 values hashing to 54697bf57ed23745baffa3ed44db8764

query I rowsort
select ntile(3) over (partition by bb order by bb desc) from analytics
----
10 values hashing to 54697bf57ed23745baffa3ed44db8764

query I rowsort
select ntile(3) over (order by bb) from analytics
----
10 values hashing to 54697bf57ed23745baffa3ed44db8764

query I rowsort
select ntile(3) over (order by bb desc) from analytics
----
10 values hashing to 54697bf57ed23745baffa3ed44db8764

query I rowsort
select ntile(10) over (partition by aa) from analytics
----
10 values hashing to a495de31cd8c6bc96c95248b0455f9c2

query I rowsort
select ntile(10) over (partition by aa order by aa asc) from analytics
----
10 values hashing to a495de31cd8c6bc96c95248b0455f9c2

query I rowsort
select ntile(10) over (partition by aa order by aa desc) from analytics
----
10 values hashing to a495de31cd8c6bc96c95248b0455f9c2

query I rowsort
select ntile(10) over (order by aa) from analytics
----
10 values hashing to ff2650590d3f27ea6644b5573ccc37ba

query I rowsort
select ntile(10) over (order by aa desc) from analytics
----
10 values hashing to ff2650590d3f27ea6644b5573ccc37ba

query I rowsort
select ntile(aa) over (partition by aa) from analytics
----
10 values hashing to f871e1c1a4d701261fdfc8918b4c2680

query I rowsort
select ntile(aa) over (partition by aa order by aa asc) from analytics
----
10 values hashing to f871e1c1a4d701261fdfc8918b4c2680

query I rowsort
select ntile(aa) over (partition by aa order by aa desc) from analytics
----
10 values hashing to f871e1c1a4d701261fdfc8918b4c2680

query I rowsort
select ntile(aa) over (order by aa) from analytics
----
10 values hashing to 378b0e9bc05cb025371d16015928bfe2

query I rowsort
select ntile(aa) over (order by aa desc) from analytics
----
10 values hashing to f8f708a022c3ac9f19ea73b87d5efa73

query I rowsort
select ntile(aa) over (partition by bb) from analytics
----
10 values hashing to 27b058d7906ad891df93c29aab24bc34

query I rowsort
select ntile(aa) over (partition by bb order by bb asc) from analytics
----
10 values hashing to 27b058d7906ad891df93c29aab24bc34

query I rowsort
select ntile(aa) over (partition by bb order by bb desc) from analytics
----
10 values hashing to 27b058d7906ad891df93c29aab24bc34

query I rowsort
select ntile(aa) over (order by bb) from analytics
----
10 values hashing to 7fedc481c0aa651a66f355fd9166c0f5

query I rowsort
select ntile(aa) over (order by bb desc) from analytics
----
10 values hashing to daf3fbd2c07451285de76c6ea2ecee88

query I rowsort
select ntile(bb) over (partition by aa) from analytics
----
10 values hashing to a495de31cd8c6bc96c95248b0455f9c2

query I rowsort
select ntile(bb) over (partition by aa order by aa asc) from analytics
----
10 values hashing to a495de31cd8c6bc96c95248b0455f9c2

query I rowsort
select ntile(bb) over (partition by aa order by aa desc) from analytics
----
10 values hashing to a495de31cd8c6bc96c95248b0455f9c2

query I rowsort
select ntile(bb) over (order by aa) from analytics
----
10 values hashing to 8839d88e6e52919d30ff7eff55219941

query I rowsort
select ntile(bb) over (order by aa desc) from analytics
----
10 values hashing to b07b6bafeaf663ee810add742cee2d04

query I rowsort
select ntile(bb) over (partition by bb) from analytics
----
10 values hashing to e43d93f234ebef0074ce0c72fc0b75b1

query I rowsort
select ntile(bb) over (partition by bb order by bb asc) from analytics
----
10 values hashing to e43d93f234ebef0074ce0c72fc0b75b1

query I rowsort
select ntile(bb) over (partition by bb order by bb desc) from analytics
----
10 values hashing to e43d93f234ebef0074ce0c72fc0b75b1

query I rowsort
select ntile(bb) over (order by bb) from analytics
----
10 values hashing to 3cc1da67c58593b22cef26c1f1f296f9

query I rowsort
select ntile(bb) over (order by bb desc) from analytics
----
10 values hashing to a495de31cd8c6bc96c95248b0455f9c2

query I rowsort
select first_value(aa) over (partition by aa) from analytics
----
10 values hashing to ce989f6ec986409e7cf421e952763d55

query I rowsort
select first_value(aa) over (partition by aa order by aa asc) from analytics
----
10 values hashing to ce989f6ec986409e7cf421e952763d55

query I rowsort
select first_value(aa) over (partition by aa order by aa desc) from analytics
----
10 values hashing to ce989f6ec986409e7cf421e952763d55

query I rowsort
select first_value(aa) over (order by aa) from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select first_value(aa) over (order by aa desc) from analytics
----
10 values hashing to f16f7876558d4bacfdad4993a413a74c

query I rowsort
select first_value(aa) over (partition by bb) from analytics
----
10 values hashing to 862543e7b183e7d869a12132115bc3d3

query I rowsort
select first_value(aa) over (partition by bb order by bb asc) from analytics
----
10 values hashing to 862543e7b183e7d869a12132115bc3d3

query I rowsort
select first_value(aa) over (partition by bb order by bb desc) from analytics
----
10 values hashing to 862543e7b183e7d869a12132115bc3d3

query I rowsort
select first_value(aa) over (order by bb) from analytics
----
10 values hashing to 10a571d85ca14138608b216a65876a7a

query I rowsort
select first_value(aa) over (order by bb desc) from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select nth_value(aa, 1) over (partition by bb) from analytics
----
10 values hashing to 862543e7b183e7d869a12132115bc3d3

query I rowsort
select nth_value(aa, 1) over (partition by bb order by bb asc) from analytics
----
10 values hashing to 862543e7b183e7d869a12132115bc3d3

query I rowsort
select nth_value(aa, 1) over (partition by bb order by bb desc) from analytics
----
10 values hashing to 862543e7b183e7d869a12132115bc3d3

query I rowsort
select nth_value(aa, 1) over (order by bb) from analytics
----
10 values hashing to 10a571d85ca14138608b216a65876a7a

query I rowsort
select nth_value(aa, 1) over (order by bb desc) from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select last_value(bb) over (partition by aa) from analytics
----
10 values hashing to a6744bdc066e831cdc5cdce8789ab565

query I rowsort
select last_value(bb) over (partition by aa order by aa asc) from analytics
----
10 values hashing to a6744bdc066e831cdc5cdce8789ab565

query I rowsort
select last_value(bb) over (partition by aa order by aa desc) from analytics
----
10 values hashing to a6744bdc066e831cdc5cdce8789ab565

query I rowsort
select last_value(bb) over (order by aa) from analytics
----
10 values hashing to a6744bdc066e831cdc5cdce8789ab565

query I rowsort
select last_value(bb) over (order by aa desc) from analytics
----
10 values hashing to a6744bdc066e831cdc5cdce8789ab565

query I rowsort
select last_value(bb) over (partition by bb) from analytics
----
10 values hashing to 4f1e70f17e0591c506e32f87331cb192

query I rowsort
select last_value(bb) over (partition by bb order by bb asc) from analytics
----
10 values hashing to 4f1e70f17e0591c506e32f87331cb192

query I rowsort
select last_value(bb) over (partition by bb order by bb desc) from analytics
----
10 values hashing to 4f1e70f17e0591c506e32f87331cb192

query I rowsort
select last_value(bb) over (order by bb) from analytics
----
10 values hashing to 4f1e70f17e0591c506e32f87331cb192

query I rowsort
select last_value(bb) over (order by bb desc) from analytics
----
10 values hashing to 4f1e70f17e0591c506e32f87331cb192

query I rowsort
select nth_value(bb, 3) over (partition by bb) from analytics
----
10 values hashing to 0a7f405d838cb866f2bdda41a6e53526

query I rowsort
select nth_value(bb, 3) over (partition by bb order by bb asc) from analytics
----
10 values hashing to 0a7f405d838cb866f2bdda41a6e53526

query I rowsort
select nth_value(bb, 3) over (partition by bb order by bb desc) from analytics
----
10 values hashing to 0a7f405d838cb866f2bdda41a6e53526

query I rowsort
select nth_value(bb, 3) over (order by bb) from analytics
----
10 values hashing to eabdbd29c5918a1ebe3bdb572dcae04a

query I rowsort
select nth_value(bb, 3) over (order by bb desc) from analytics
----
10 values hashing to a908eae5d690f6a2bab5b8b619a143f2

query I rowsort
select lag(bb) over (partition by aa) from analytics
----
10 values hashing to 5d45ea499a6438ad4d2cb02c11afaab2

query I rowsort
select lag(bb) over (partition by aa order by aa asc) from analytics
----
10 values hashing to 5d45ea499a6438ad4d2cb02c11afaab2

query I rowsort
select lag(bb) over (partition by aa order by aa desc) from analytics
----
10 values hashing to 5d45ea499a6438ad4d2cb02c11afaab2

query I rowsort
select lag(bb) over (order by aa) from analytics
----
10 values hashing to 711429f15026ad2b819c6937b6a4a385

query I rowsort
select lag(bb) over (order by aa desc) from analytics
----
10 values hashing to 0a7f405d838cb866f2bdda41a6e53526

query I rowsort
select lead(bb) over (partition by bb) from analytics
----
10 values hashing to 4d227310307eadde3028329cd8ece0ca

query I rowsort
select lead(bb) over (partition by bb order by bb asc) from analytics
----
10 values hashing to 4d227310307eadde3028329cd8ece0ca

query I rowsort
select lead(bb) over (partition by bb order by bb desc) from analytics
----
10 values hashing to 4d227310307eadde3028329cd8ece0ca

query I rowsort
select lead(bb) over (order by bb) from analytics
----
10 values hashing to 657c4502c8c8ae0722e090e8dd41a128

query I rowsort
select lead(bb) over (order by bb desc) from analytics
----
10 values hashing to 0a7f405d838cb866f2bdda41a6e53526

query R rowsort
select percent_rank() over () from analytics
----
10 values hashing to 5395eb5827c9cdfa042cd5e47d31da11

query R rowsort
select cume_dist() over () from analytics
----
10 values hashing to 6b30ac6cf647148cb343fab8333da947

query I rowsort
select ntile(1) over () from analytics
----
10 values hashing to eabdbd29c5918a1ebe3bdb572dcae04a

query I rowsort
select ntile(2) over () from analytics
----
10 values hashing to a22626845b7b64b173b733db11578f22

query I rowsort
select ntile(5) over () from analytics
----
10 values hashing to 963829efae320775f796c643e8848ba6

query I rowsort
select ntile(11) over () from analytics
----
10 values hashing to ff2650590d3f27ea6644b5573ccc37ba

query I rowsort
select ntile(100) over () from analytics
----
10 values hashing to ff2650590d3f27ea6644b5573ccc37ba

query I rowsort
select first_value(aa) over () from analytics
----
10 values hashing to f16f7876558d4bacfdad4993a413a74c

query I rowsort
select first_value(bb) over () from analytics
----
10 values hashing to 10a571d85ca14138608b216a65876a7a

query I rowsort
select last_value(aa) over () from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select last_value(bb) over () from analytics
----
10 values hashing to 435a973fa5179dbc7eeeb4ccf5ede561

query I rowsort
select nth_value(aa, 2) over () from analytics
----
10 values hashing to 10a571d85ca14138608b216a65876a7a

query I rowsort
select nth_value(bb, 1) over () from analytics
----
10 values hashing to 10a571d85ca14138608b216a65876a7a

query I rowsort
select nth_value(bb, 1000) over () from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select lag(aa) over () from analytics
----
10 values hashing to ce989f6ec986409e7cf421e952763d55

query I rowsort
select lead(bb) over () from analytics
----
10 values hashing to 711429f15026ad2b819c6937b6a4a385

query I rowsort
select lag(aa) over () from analytics
----
10 values hashing to ce989f6ec986409e7cf421e952763d55

query I rowsort
select lead(bb) over () from analytics
----
10 values hashing to 711429f15026ad2b819c6937b6a4a385

query I rowsort
select ntile(null) over () from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select first_value(null) over () from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select last_value(null) over () from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select nth_value(null, 1) over () from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select nth_value(aa, null) over () from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select nth_value(1, null) over () from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select nth_value(null, null) over () from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select lag(null) over () from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select lag(null, null) over () from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select lag(null, null, null) over () from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select lead(null) over () from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select lead(null, null) over () from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

query I rowsort
select lead(null, null, null) over () from analytics
----
10 values hashing to db761b746c7d0f18810c20311a9f8974

statement ok
create table stressme (aa varchar(64), bb int)

statement ok
insert into stressme values ('one', 1), ('another', 1), ('stress', 1), (NULL, 2), ('ok', 2), ('check', 3), ('me', 3), ('please', 3), (NULL, 4)

query T rowsort
select first_value(aa) over (partition by bb) from stressme
----
NULL
NULL
NULL
check
check
check
one
one
one

query T rowsort
select first_value(aa) over (partition by bb order by bb asc) from stressme
----
NULL
NULL
NULL
check
check
check
one
one
one

query T rowsort
select first_value(aa) over (partition by bb order by bb desc) from stressme
----
NULL
NULL
NULL
check
check
check
one
one
one

query T rowsort
select first_value(aa) over (order by bb) from stressme
----
one
one
one
one
one
one
one
one
one

query T rowsort
select first_value(aa) over (order by bb desc) from stressme
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I rowsort
select first_value(bb) over (partition by aa) from stressme
----
1
1
1
2
2
2
3
3
3

query I rowsort
select first_value(bb) over (partition by aa order by aa asc) from stressme
----
1
1
1
2
2
2
3
3
3

query I rowsort
select first_value(bb) over (partition by aa order by aa desc) from stressme
----
1
1
1
2
2
2
3
3
3

query I rowsort
select first_value(bb) over (order by aa) from stressme
----
2
2
2
2
2
2
2
2
2

query I rowsort
select first_value(bb) over (order by aa desc) from stressme
----
1
1
1
1
1
1
1
1
1

query T rowsort
select last_value(aa) over (partition by bb) from stressme
----
NULL
ok
ok
please
please
please
stress
stress
stress

query T rowsort
select last_value(aa) over (partition by bb order by bb asc) from stressme
----
NULL
ok
ok
please
please
please
stress
stress
stress

query T rowsort
select last_value(aa) over (partition by bb order by bb desc) from stressme
----
NULL
ok
ok
please
please
please
stress
stress
stress

query T rowsort
select last_value(aa) over (order by bb) from stressme
----
NULL
ok
ok
please
please
please
stress
stress
stress

query T rowsort
select last_value(aa) over (order by bb desc) from stressme
----
NULL
ok
ok
please
please
please
stress
stress
stress

query I rowsort
select last_value(bb) over (partition by aa) from stressme
----
1
1
1
2
3
3
3
4
4

query I rowsort
select last_value(bb) over (partition by aa order by aa asc) from stressme
----
1
1
1
2
3
3
3
4
4

query I rowsort
select last_value(bb) over (partition by aa order by aa desc) from stressme
----
1
1
1
2
3
3
3
4
4

query I rowsort
select last_value(bb) over (order by aa) from stressme
----
1
1
1
2
3
3
3
4
4

query I rowsort
select last_value(bb) over (order by aa desc) from stressme
----
1
1
1
2
3
3
3
4
4

query T rowsort
select nth_value(aa, 1) over (partition by bb) from stressme
----
NULL
NULL
NULL
check
check
check
one
one
one

query T rowsort
select nth_value(aa, 1) over (partition by bb order by bb asc) from stressme
----
NULL
NULL
NULL
check
check
check
one
one
one

query T rowsort
select nth_value(aa, 1) over (partition by bb order by bb desc) from stressme
----
NULL
NULL
NULL
check
check
check
one
one
one

query T rowsort
select nth_value(aa, 1) over (order by bb) from stressme
----
one
one
one
one
one
one
one
one
one

query T rowsort
select nth_value(aa, 1) over (order by bb desc) from stressme
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query T rowsort
select nth_value(aa, 5) over (partition by bb) from stressme
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query T rowsort
select nth_value(aa, 5) over (partition by bb order by bb asc) from stressme
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query T rowsort
select nth_value(aa, 5) over (partition by bb order by bb desc) from stressme
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query T rowsort
select nth_value(aa, 5) over (order by bb) from stressme
----
NULL
NULL
NULL
ok
ok
ok
ok
ok
ok

query T rowsort
select nth_value(aa, 5) over (order by bb desc) from stressme
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I rowsort
select nth_value(bb, 1) over (partition by aa) from stressme
----
1
1
1
2
2
2
3
3
3

query I rowsort
select nth_value(bb, 1) over (partition by aa order by aa asc) from stressme
----
1
1
1
2
2
2
3
3
3

query I rowsort
select nth_value(bb, 1) over (partition by aa order by aa desc) from stressme
----
1
1
1
2
2
2
3
3
3

query I rowsort
select nth_value(bb, 1) over (order by aa) from stressme
----
2
2
2
2
2
2
2
2
2

query I rowsort
select nth_value(bb, 1) over (order by aa desc) from stressme
----
1
1
1
1
1
1
1
1
1

query I rowsort
select nth_value(bb, 5) over (partition by aa) from stressme
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I rowsort
select nth_value(bb, 5) over (partition by aa order by aa asc) from stressme
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I rowsort
select nth_value(bb, 5) over (partition by aa order by aa desc) from stressme
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I rowsort
select nth_value(bb, 5) over (order by aa) from stressme
----
3
3
3
3
3
NULL
NULL
NULL
NULL

query I rowsort
select nth_value(bb, 5) over (order by aa desc) from stressme
----
3
3
3
3
3
NULL
NULL
NULL
NULL

query T rowsort
select lag(aa) over (partition by bb) from stressme
----
NULL
NULL
NULL
NULL
NULL
another
check
me
one

query T rowsort
select lag(aa) over (partition by bb order by bb asc) from stressme
----
NULL
NULL
NULL
NULL
NULL
another
check
me
one

query T rowsort
select lag(aa) over (partition by bb order by bb desc) from stressme
----
NULL
NULL
NULL
NULL
NULL
another
check
me
one

query T rowsort
select lag(aa) over (order by bb) from stressme
----
NULL
NULL
another
check
me
ok
one
please
stress

query T rowsort
select lag(aa) over (order by bb desc) from stressme
----
NULL
NULL
NULL
another
check
me
ok
one
please

query T rowsort
select lead(aa) over (partition by bb) from stressme
----
NULL
NULL
NULL
NULL
another
me
ok
please
stress

query T rowsort
select lead(aa) over (partition by bb order by bb asc) from stressme
----
NULL
NULL
NULL
NULL
another
me
ok
please
stress

query T rowsort
select lead(aa) over (partition by bb order by bb desc) from stressme
----
NULL
NULL
NULL
NULL
another
me
ok
please
stress

query T rowsort
select lead(aa) over (order by bb) from stressme
----
NULL
NULL
NULL
another
check
me
ok
please
stress

query T rowsort
select lead(aa) over (order by bb desc) from stressme
----
NULL
NULL
another
check
me
ok
one
please
stress

query I rowsort
select lag(bb) over (partition by aa) from stressme
----
2
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I rowsort
select lag(bb) over (partition by aa order by aa asc) from stressme
----
2
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I rowsort
select lag(bb) over (partition by aa order by aa desc) from stressme
----
2
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I rowsort
select lag(bb) over (order by aa) from stressme
----
1
1
2
2
3
3
3
4
NULL

query I rowsort
select lag(bb) over (order by aa desc) from stressme
----
1
1
1
2
2
3
3
3
NULL

query I rowsort
select lead(bb) over (partition by aa) from stressme
----
4
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I rowsort
select lead(bb) over (partition by aa order by aa asc) from stressme
----
4
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I rowsort
select lead(bb) over (partition by aa order by aa desc) from stressme
----
4
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I rowsort
select lead(bb) over (order by aa) from stressme
----
1
1
1
2
3
3
3
4
NULL

query I rowsort
select lead(bb) over (order by aa desc) from stressme
----
1
1
2
2
3
3
3
4
NULL

query IIII rowsort
select aa, bb, lead(aa, 2, 100) over (partition by bb), lead(aa, 1, '100') over (partition by bb) from analytics
----
40 values hashing to 5d87490c8911e56c02113cfe47bab4af

query I rowsort
select nth_value(aa, aa) over () from analytics
----
10 values hashing to 78ab2ce87f46591d31bc705bfa3b8455

query I rowsort
select nth_value(1, aa) over () from analytics
----
10 values hashing to 85893b34ac9e822f53d59442edee1d2c

statement ok
create table t1 (col1 int, col2 int)

statement ok
insert into t1 values (8481, 0), (8489, 0), (8489, 1), (8498, 0), (8498, 1), (8498, 2), (8507, 0), (8507, 1), (8507, 2)

query IIIII rowsort
select col1, col2, lag(col2) over (partition by col1 ORDER BY col2), lag(col2, 2) over (partition by col1 ORDER BY col2), lag(col2, 3) over (partition by col1 ORDER BY col2) from t1
----
45 values hashing to 179eb6609b31d4aa18a15641cdc5ac14

query III rowsort
select lag(col2, -1) over (partition by col1 ORDER BY col2), lag(col2, 1) over (partition by col1 ORDER BY col2), lag(col2, 2) over (partition by col1 ORDER BY col2) from t1
----
27 values hashing to 117bee1cc71734cf78d3d28bff9d3d62

query III rowsort
select lead(col2, -1) over (partition by col1 ORDER BY col2), lead(col2, 1) over (partition by col1 ORDER BY col2), lead(col2, 2) over (partition by col1 ORDER BY col2) from t1
----
27 values hashing to d37c588b61a725acd861e3fc336f0dd6

statement ok
CREATE TABLE "sys"."test1" (
	"name"       VARCHAR(100),
	"points"     DOUBLE,
	"start_time" TIMESTAMP
)

statement ok
COPY 8 RECORDS INTO "sys"."test1" FROM stdin USING DELIMITERS E'\t',E'\n','"'
<COPY_INTO_DATA>
"Hello"	20	"2017-12-01 00:00:00.000000"
"Hello"	40	"2017-12-01 01:00:00.000000"
"Hello"	60	"2017-12-01 00:00:00.000000"
"World"	10	"2017-12-01 00:00:00.000000"
"World"	50	"2017-12-01 01:00:00.000000"
"World"	90	"2017-12-01 00:00:00.000000"
"World"	11	"2017-12-02 01:02:00.000000"
"World"	15	"2017-12-02 02:02:00.000000"

query TRR rowsort
SELECT CAST(t0.start_time AS DATE) AS start_time,
FIRST_VALUE(t0.points) OVER (PARTITION BY CAST(t0.start_time AS DATE) ORDER BY t0.start_time) AS first_point,
LAST_VALUE(t0.points) OVER (PARTITION BY CAST(t0.start_time AS DATE) ORDER BY t0.start_time) AS last_point
FROM test1 t0
WHERE (t0.start_time >= '2017/12/01 00:00:00' AND t0.start_time <= '2017/12/02 00:00:00')
----
18 values hashing to 3412ec70d8662695814cb27b52aa144e

query TRR rowsort
SELECT DISTINCT CAST(t0.start_time AS DATE) AS start_time,
FIRST_VALUE(t0.points) OVER (PARTITION BY CAST(t0.start_time AS DATE) ORDER BY t0.start_time) AS first_point,
LAST_VALUE(t0.points) OVER (PARTITION BY CAST(t0.start_time AS DATE) ORDER BY t0.start_time) AS last_point
FROM test1 t0
WHERE (t0.start_time >= '2017/12/01 00:00:00' AND t0.start_time <= '2017/12/02 00:00:00')
----
2017-12-01
20.000
50.000
2017-12-01
20.000
90.000

statement ok
CREATE TABLE "sys"."test2" (
	"name"       VARCHAR(100),
	"points"     INT,
	"start_time" TIMESTAMP
)

statement ok
COPY 8 RECORDS INTO "sys"."test2" FROM stdin USING DELIMITERS E'\t',E'\n','"'
<COPY_INTO_DATA>
"Ashish"	20	"2017-12-01 00:00:00.000000"
"Ashish"	40	"2017-12-01 01:00:00.000000"
"Ashish"	60	"2017-12-01 00:00:00.000000"
"Prashant"	10	"2017-12-01 00:00:00.000000"
"Prashant"	50	"2017-12-01 01:00:00.000000"
"Prashant"	90	"2017-12-01 00:00:00.000000"
"Prashant"	11	"2017-12-02 01:02:00.000000"
"Prashant"	15	"2017-12-02 02:02:00.000000"

query TI rowsort
SELECT distinct "name" ,
first_value("points") over (partition by cast("start_time" as date) order by cast("start_time" as date))
FROM test2
order by "name"
----
Ashish
20
Prashant
11
Prashant
20

query TI rowsort
SELECT distinct "name" ,
first_value("points") over (partition by cast("start_time" as date), "name" order by cast("start_time" as date))
FROM test2
order by "name"
----
Ashish
20
Prashant
10
Prashant
11

statement ok
rollback

statement error
select ntile(1) from analytics

statement error
select ntile(distinct aa) over () from analytics

statement error
select nth_value(distinct aa, bb) over () from analytics

statement error
select lead(aa, 34, 1000000000000) over (partition by bb) from analytics

statement ok
drop table analytics



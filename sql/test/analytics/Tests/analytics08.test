statement ok
create table analytics (aa int, bb int)

statement ok
insert into analytics values (15, 3), (3, 1), (2, 1), (5, 3), (NULL, 2), (3, 2), (4, 1), (6, 3), (8, 2), (NULL, 4)

statement ok
start transaction

query I rowsort
select first_value(aa) over (w order by bb) from analytics window w as (partition by bb)
----
10 values hashing to 862543e7b183e7d869a12132115bc3d3

query II rowsort
select first_value(aa) over (w1 order by bb),
       last_value(aa) over (w2 order by bb) from analytics window w1 as (w2), w2 as (), w3 as (w1)
----
20 values hashing to 3773b8d916622b82fe502fd65f16be25

query III rowsort
select first_value(aa) over (w1 partition by bb),
       last_value(aa) over (w2 range unbounded preceding),
       count(aa) over (w3) from analytics window w1 as (w2), w2 as (order by bb), w3 as (w2 partition by bb)
----
30 values hashing to 5d721cb8ee2ba18d7f7ec923861a8798

statement ok
rollback

statement error
select first_value(aa) over (w1 order by bb) from analytics

statement error
select first_value(aa) over (w1 order by aa),
       last_value(aa) over (w2) from analytics window w1 as (w2), w2 as (order by bb)

statement error
select first_value(aa) over (w1 order by bb),
       last_value(aa) over (w2 order by bb) from analytics window w1 as (w2), w2 as (w3), w3 as (w1)

statement ok
drop table analytics



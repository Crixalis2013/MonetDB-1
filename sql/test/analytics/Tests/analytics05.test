statement ok
create table analytics (aa int, bb int, cc bigint)

statement ok
insert into analytics values (15, 3, 15), (3, 1, 3), (2, 1, 2), (5, 3, 5), (NULL, 2, NULL), (3, 2, 3), (4, 1, 4), (6, 3, 6), (8, 2, 8), (NULL, 4, NULL)

query II rowsort
select count(*) over w, cast(sum(aa) over w as bigint)
    from analytics window w as (rows between 5 preceding and 0 following)
----
20 values hashing to 3b5fd838045ffbbe5314d25e5dd8fa28

statement error
select count(*) over w, cast(sum(aa) over w as bigint)
    from analytics window w as (rows between 5 preceding and 0 following), w as (range between 5 preceding and 0 following)

statement error
select count(*) over w, cast(sum(aa) over w as bigint)
    from analytics

query IIR rowsort
select count(*) over w, cast(sum(aa) over z as bigint), avg(aa) over z
    from analytics window w as (rows between 5 preceding and 0 following), z as (order by bb range unbounded preceding)
----
30 values hashing to c8b1a4ef79e7d3f552639e69d452113e

query I rowsort
with helper as (select count(*) over w as counted from analytics window w as (order by bb))
    select count(*) over w from helper window w as (rows unbounded preceding)
----
10 values hashing to ff2650590d3f27ea6644b5573ccc37ba

query I rowsort
select count(*) over w window w as ()
----
1

query I rowsort
select (select count(*) over w window w as ())
----
1

statement ok
drop table analytics


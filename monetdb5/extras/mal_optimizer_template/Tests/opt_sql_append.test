statement ok
set optimizer = 'sequential_pipe'

statement ok
create table ttt (averylongcolumnnametomakeitlargeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee int, b int, c int)

query T rowsort
select optimizer
----
sequential_pipe

query T rowsort
select def from optimizers() where name = optimizer
----
optimizer.inline();optimizer.remap();optimizer.costModel();optimizer.coercions();optimizer.aliases();optimizer.evaluate();optimizer.emptybind();optimizer.pushselect();optimizer.aliases();optimizer.mergetable();optimizer.deadcode();optimizer.aliases();optimizer.constants();optimizer.commonTerms();optimizer.projectionpath();optimizer.deadcode();optimizer.reorder();optimizer.matpack();optimizer.querylog();optimizer.multiplex();optimizer.generator();optimizer.profiler();optimizer.candidates();optimizer.deadcode();optimizer.postfix();optimizer.wlc();optimizer.garbageCollector();

query T python explain.function_histogram
explain copy into ttt from '/tmp/xyz'
----
user.main
2
querylog.define
1
sql.mvc
1
sql.copy_from
1
sql.append
3
aggr.count
1
sql.affectedRows
1

statement error
explain copy into ttt from E'\\tmp/xyz'

statement error
explain copy into ttt from E'a:\\tmp/xyz'

statement ok
start transaction

statement ok
create local temp table "opt_pipe_name" ("opt_pipe_name" string)

statement ok
insert into "opt_pipe_name" values ((select optimizer))

statement ok
set optimizer = substring((select def from optimizers() where name = (select opt_pipe_name from "opt_pipe_name")),0,
                length((select def from optimizers() where name = (select opt_pipe_name from "opt_pipe_name")))-length('optimizer.garbageCollector();')) || 'optimizer.sql_append();optimizer.garbageCollector();'

query T rowsort
select optimizer
----
user_0

query T rowsort
select def from optimizers() where name = optimizer
----
optimizer.inline();optimizer.remap();optimizer.costModel();optimizer.coercions();optimizer.aliases();optimizer.evaluate();optimizer.emptybind();optimizer.pushselect();optimizer.aliases();optimizer.mergetable();optimizer.deadcode();optimizer.aliases();optimizer.constants();optimizer.commonTerms();optimizer.projectionpath();optimizer.deadcode();optimizer.reorder();optimizer.matpack();optimizer.querylog();optimizer.multiplex();optimizer.generator();optimizer.profiler();optimizer.candidates();optimizer.deadcode();optimizer.postfix();optimizer.wlc();optimizer.sql_append();optimizer.garbageCollector();

statement ok
rollback

query T python explain.function_histogram
explain copy into ttt from '/tmp/xyz'
----
user.main
2
querylog.define
1
sql.mvc
1
sql.copy_from
1
sql.append
3
aggr.count
1
sql.affectedRows
1

statement error
explain copy into ttt from E'\\tmp/xyz'

statement error
explain copy into ttt from 'Z:/tmp/xyz'

statement ok
drop table ttt

statement ok
set optimizer = 'default_pipe'



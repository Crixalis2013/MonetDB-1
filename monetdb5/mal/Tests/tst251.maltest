statement ok
c:= bat.new(:str)

statement ok
bat.append(c,"hello")

statement ok
bat.append(c,"brave")

statement ok
bat.append(c,"world")

statement ok
bat.append(c,"")

statement ok
x:= calc.str(nil)

statement ok
bat.append(c,x)

statement ok
bat.append(c,"!")

query TT rowsort
io.print(c)
----
12 values hashing to 7621f20bcb9c64b3a189dc2c9a005bb4

statement ok
barrier (h,ts):= iterator.new(c)

statement ok
	io.printf("[%d,",h)

statement ok
	io.printf("%s]\n",ts)

statement ok
	redo (h,ts):= iterator.next(c)

query T rowsort
exit (h,ts)
----
0,hello
1,brave
2,world
3,
4,nil
5,!



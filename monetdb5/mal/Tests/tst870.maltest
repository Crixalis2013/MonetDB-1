statement ok
function foo();
b := bat.new(:oid);
bat.append(b,0@0);
bat.append(b,1@0);
bat.append(b,2@0);
bat.append(b,3@0);
bat.append(b,2@0);
bat.append(b,0@0);
bat.append(b,3@0);
bat.append(b,nil:oid);
bat.append(b,1@0);
g := bat.new(:oid);
bat.append(g,0@0);
bat.append(g,1@0);
bat.append(g,1@0);
bat.append(g,1@0);
bat.append(g,2@0);
bat.append(g,2@0);
bat.append(g,2@0);
bat.append(g,3@0);
bat.append(g,3@0);
#io.print(g,b);
# only head is used
e := bat.new(:oid);
bat.append(e,0@0);
bat.append(e,1@0);
bat.append(e,2@0);
bat.append(e,3@0);
i := aggr.min(b,g,e);
h := aggr.max(b,g,e);
io.print(i,h);
end foo;

query TTT rowsort
user.foo();
----
12 values hashing to 9e65a7e5335883fb89a1cc76f31ab9ff



statement ok
b1:= bat.new(:int)

statement ok
b2:= bat.new(:flt)

statement ok
bat.append(b1,1)

statement ok
bat.append(b1,2)

statement ok
bat.append(b1,3)

statement ok
bat.append(b1,4)

statement ok
bat.append(b1,2)

statement ok
bat.append(b2, 12.31)

statement ok
bat.append(b2, 12.32)

statement ok
bat.append(b2, 12.33)

statement ok
bat.append(b2, 12.34)

statement ok
bat.append(b2, 12.35)

query TIT rowsort
io.print(b1,b2)
----
15 values hashing to feaced8a9a1855a8e337ffe1dc3f7fa8

statement ok
s:= algebra.select(b1,nil:bat[:oid],2,2,true,true,false)

query TT rowsort
io.print(s)
----
0
1
1
4

statement ok
bat.delete(b1,s)

query TI rowsort
io.print(b1)
----
0
1
1
3
2
4

statement ok
bat.delete(b2,s)

query TT rowsort
io.print(b2)
----
0
12.31
1
12.33
2
12.34

query TIT rowsort
io.print(b1,b2)
----
0
1
12.31
1
3
12.33
2
4
12.34



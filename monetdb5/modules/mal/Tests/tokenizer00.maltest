statement ok
include tokenizer

statement ok
tokenizer.open("test")

statement ok
tokenizer.append("http://www.cwi.nl")

statement ok
tokenizer.append("http://www.cwi.nl/")

statement ok
tokenizer.append("http://www.cwi.nl/~lsidir")

statement ok
tokenizer.append("http://www.cwi.nl/~mk")

statement ok
tokenizer.append("http://www.cwi.nl/~mk")

statement ok
tokenizer.append("http://www.ics.forth.gr")

statement ok
tokenizer.append("http://www.ics.forth.gr/")

statement ok
tokenizer.append("http://www.ics.forth.gr/~lsidir")

statement ok
tokenizer.append("http://www.cook.gr/")

statement ok
tokenizer.append("http://www.cook.gr/~lsidir")

statement ok
tokenizer.append("http://www.cook.gr/~mk")

statement ok
tokenizer.append("http://www.nocook.nl/~mk")

statement ok
tokenizer.append("http://www.nocook.nl/")

statement ok
tokenizer.append("ftp://thepiratebay.org")

statement ok
id := 4:oid

statement ok
t  := tokenizer.take(id)

query T rowsort
io.print(t)
----
"http://www.ics.forth.gr/~lsidir/"

statement ok
id := tokenizer.locate(t)

query T rowsort
io.print(id)
----
4@0

statement ok
d:bat[:oid] := tokenizer.getIndex()

query TT rowsort
io.print(d)
----
22 values hashing to 9470a002ce5426b6991f347c773a6be3

statement ok
level0:bat[:str] := tokenizer.getLevel(0)

statement ok
level1:bat[:str] := tokenizer.getLevel(1)

statement ok
level2:bat[:str] := tokenizer.getLevel(2)

statement ok
level3:bat[:str] := tokenizer.getLevel(3)

query TT rowsort
io.print(level0)
----
@
ftp:
@
http:

query TT rowsort
io.print(level1)
----
@
(empty)
@
(empty)

query TT rowsort
io.print(level2)
----
10 values hashing to fdea139e691b3dd9e7725d5e96c3d866

query TT rowsort
io.print(level3)
----
12 values hashing to f5bc5b38cb9d33608b3bddfb2d56ebe7

statement ok
cnt:bat[:lng] := tokenizer.getCount()

query TT rowsort
io.print(cnt)
----
@
2
@
2
@
5
@
6

statement ok
cnt:bat[:lng] := tokenizer.getCardinality()

query TT rowsort
io.print(cnt)
----
@
1
@
2
@
2
@
5

statement ok
tokenizer.close()


statement ok
include tokenizer

statement ok
tokenizer.open("test")

statement ok
tokenizer.append("http://www.cwi.nl")

statement ok
tokenizer.append("http://www.cwi.nl/")

statement ok
tokenizer.append("http://www.cwi.nl/~lsidir")

statement ok
tokenizer.append("http://www.cwi.nl/~mk")

statement ok
tokenizer.append("http://www.cwi.nl/~mk")

statement ok
tokenizer.append("http://www.ics.forth.gr")

statement ok
tokenizer.append("http://www.ics.forth.gr/")

statement ok
tokenizer.append("http://www.ics.forth.gr/~lsidir")

statement ok
tokenizer.append("http://www.cook.gr/")

statement ok
tokenizer.append("http://www.cook.gr/~lsidir")

statement ok
tokenizer.append("http://www.cook.gr/~mk")

statement ok
tokenizer.append("http://www.nocook.nl/~mk")

statement ok
tokenizer.append("http://www.nocook.nl/")

statement ok
tokenizer.append("ftp://thepiratebay.org")

statement ok
id := 4:oid

statement ok
t  := tokenizer.take(id)

query T rowsort
io.print(t)
----
"http://www.ics.forth.gr/~lsidir/"

statement ok
id := tokenizer.locate(t)

query T rowsort
io.print(id)
----
4@0

statement ok
d:bat[:oid] := tokenizer.getIndex()

query TT rowsort
io.print(d)
----
22 values hashing to 838f4c3374169047ef1bd1b41199a551

statement ok
level0:bat[:str] := tokenizer.getLevel(0)

statement ok
level1:bat[:str] := tokenizer.getLevel(1)

statement ok
level2:bat[:str] := tokenizer.getLevel(2)

statement ok
level3:bat[:str] := tokenizer.getLevel(3)

query TT rowsort
io.print(level0)
----
0
http:
1
ftp:

query TT rowsort
io.print(level1)
----
0
(empty)
1
(empty)

query TT rowsort
io.print(level2)
----
10 values hashing to fead9045c1d61ce1dd2a95b1c08794e7

query TT rowsort
io.print(level3)
----
12 values hashing to 3c077dca9960fa9a48382145d11908b6

statement ok
cnt:bat[:lng] := tokenizer.getCount()

query TT rowsort
io.print(cnt)
----
0
2
1
2
2
5
3
6

statement ok
cnt:bat[:lng] := tokenizer.getCardinality()

query TT rowsort
io.print(cnt)
----
0
2
1
1
2
5
3
2

statement ok
tokenizer.close()



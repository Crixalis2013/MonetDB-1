statement ok
function user.remote_internal_servegetbat(type:str, o:bat[:any_2]):void

statement ok
    t := inspect.getType(o)

statement ok
    barrier ifpart := type == t

statement ok
        len := aggr.count(o)

statement ok
        io.print(o)

statement ok
    exit ifpart

statement ok
    barrier ifpart := calc.isnil(type)

statement ok
        io.printf("!MALException:user.serveget:nil type doesn't match anything\n")

statement ok
    exit ifpart

statement ok
    barrier ifpart := type != t

statement ok
        io.printf("!MALException:user.serveget:object type (%s) ", t)

statement ok
        io.printf("does not match required type (%s)\n", type)

statement ok
    exit ifpart

statement ok
end user.remote_internal_servegetbat

statement ok
function user.remote_internal_serveget(type:str, o:any):void

statement ok
    t := inspect.getType(o)

statement ok
    barrier ifpart := type == t

statement ok
        io.print(o)

statement ok
    exit ifpart

statement ok
    barrier ifpart := calc.isnil(type)

statement ok
        io.printf("!MALException:user.serveget:nil type doesn't match anything\n")

statement ok
    exit ifpart

statement ok
    barrier ifpart := type != t

statement ok
        io.printf("!MALException:user.serveget:object type (%s) ", t)

statement ok
        io.printf("does not match required type (%s)\n", type)

statement ok
    exit ifpart

statement ok
end user.remote_internal_serveget

statement ok
remote_test_id_0 := bat.new( :str, 33)

statement ok
bat.append(remote_test_id_0, "oid":str)

query TT rowsort
user.remote_internal_servegetbat("bat[:str]",remote_test_id_0)
----
@
oid


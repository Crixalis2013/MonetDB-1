statement ok
a:= bat.new(:int)

statement ok
bat.append(a,1)

statement ok
bat.append(a,0)

statement ok
bat.append(a,2)

statement ok
bat.append(a,2)

statement ok
bat.append(a,3)

statement ok
bat.append(a,3)

statement ok
bat.append(a,3)

query TI rowsort
io.print(a)
----
14 values hashing to 5c5cc47d859c43221c4b848f49a2ebd3

statement ok
b:= bat.new(:int)

statement ok
bat.append(b,1)

statement ok
bat.append(b,0)

statement ok
bat.append(b,2)

statement ok
bat.append(b,2)

statement ok
bat.append(b,5)

statement ok
bat.append(b,5)

statement ok
bat.append(b,3)

query TI rowsort
io.print(b)
----
14 values hashing to 6f65e6b8b547c5732d61c715af858a15

statement ok
bp:= algebra.firstn(b,nil:bat,nil:bat,0:lng,false,true,false)

query TT rowsort
io.print(bp)
----

statement ok
bp:= algebra.firstn(b,nil:bat,nil:bat,1:lng,false,true,false)

query TT rowsort
io.print(bp)
----
0
4

statement ok
bp:= algebra.firstn(b,nil:bat,nil:bat,2:lng,false,true,false)

query TT rowsort
io.print(bp)
----
0
4
1
5

statement ok
bp:= algebra.firstn(b,nil:bat,nil:bat,3:lng,false,true,false)

query TT rowsort
io.print(bp)
----
0
4
1
5
2
6

statement ok
bp:= algebra.firstn(b,nil:bat,nil:bat,4:lng,false,true,false)

query TT rowsort
io.print(bp)
----
0
3
1
4
2
5
3
6

statement ok
bp:= algebra.firstn(b,nil:bat,nil:bat,5:lng,false,true,false)

query TT rowsort
io.print(bp)
----
10 values hashing to 9366dac70a8c800c4a3ba376d3995e4b

statement ok
bp:= algebra.firstn(b,nil:bat,nil:bat,6:lng,false,true,false)

query TT rowsort
io.print(bp)
----
12 values hashing to 0c93b862b714640e965b921e1f8ab8ff

statement ok
bp:= algebra.firstn(b,nil:bat,nil:bat,7:lng,false,true,false)

query TT rowsort
io.print(bp)
----
14 values hashing to 85ff96c644d3ad69de07d013f0043314

statement ok
bp:= algebra.firstn(b,nil:bat,nil:bat,8:lng,false,true,false)

query TT rowsort
io.print(bp)
----
14 values hashing to 85ff96c644d3ad69de07d013f0043314

query T rowsort
io.print("Start of compound")
----
"Start of compound"

statement ok
(bp,bg):= algebra.firstn(b,nil:bat,nil:bat,0:lng,false,true,false)

query TT rowsort
io.print(bp)
----

query TT rowsort
io.print(bg)
----

statement ok
(cp,cg):= algebra.firstn(a,bp,bg,0:lng,false,true,false)

query TT rowsort
io.print(cp)
----

statement ok
(bp,bg):= algebra.firstn(b,nil:bat,nil:bat,1:lng,false,true,false)

query TT rowsort
io.print(bp)
----
0
4
1
5

query TT rowsort
io.print(bg)
----
0
0
1
0

statement ok
(cp,cg):= algebra.firstn(a,bp,bg,1:lng,false,true,false)

query TT rowsort
io.print(cp)
----
0
4
1
5

query TT rowsort
io.print(cg)
----
0
0
1
0

statement ok
(bp,bg):= algebra.firstn(b,nil:bat,nil:bat,2:lng,false,true,false)

query TT rowsort
io.print(bp)
----
0
4
1
5

query TT rowsort
io.print(bg)
----
0
0
1
0

statement ok
(cp,cg):= algebra.firstn(a,bp,bg,2:lng,false,true,false)

query TT rowsort
io.print(cp)
----
0
4
1
5

query TT rowsort
io.print(cg)
----
0
0
1
0

statement ok
(bp,bg):= algebra.firstn(b,nil:bat,nil:bat,3:lng,false,true,false)

query TT rowsort
io.print(bp)
----
0
4
1
5
2
6

query TT rowsort
io.print(bg)
----
0
0
1
0
2
1

statement ok
(cp,cg):= algebra.firstn(a,bp,bg,3:lng,false,true,false)

query TT rowsort
io.print(cp)
----
0
4
1
5
2
6

query TT rowsort
io.print(cg)
----
0
0
1
0
2
1

statement ok
(bp,bg):= algebra.firstn(b,nil:bat,nil:bat,4:lng,false,true,false)

query TT rowsort
io.print(bp)
----
10 values hashing to 9366dac70a8c800c4a3ba376d3995e4b

query TT rowsort
io.print(bg)
----
10 values hashing to 50c2f7e4272444652de778c5078bd293

statement ok
(cp,cg):= algebra.firstn(a,bp,bg,4:lng,false,true,false)

query TT rowsort
io.print(cp)
----
10 values hashing to 9366dac70a8c800c4a3ba376d3995e4b

query TT rowsort
io.print(cg)
----
10 values hashing to 50c2f7e4272444652de778c5078bd293

statement ok
(bp,bg):= algebra.firstn(b,nil:bat,nil:bat,5:lng,false,true,false)

query TT rowsort
io.print(bp)
----
10 values hashing to 9366dac70a8c800c4a3ba376d3995e4b

query TT rowsort
io.print(bg)
----
10 values hashing to 50c2f7e4272444652de778c5078bd293

statement ok
(cp,cg):= algebra.firstn(a,bp,bg,5:lng,false,true,false)

query TT rowsort
io.print(cp)
----
10 values hashing to 9366dac70a8c800c4a3ba376d3995e4b

query TT rowsort
io.print(cg)
----
10 values hashing to 50c2f7e4272444652de778c5078bd293

statement ok
(bp,bg):= algebra.firstn(b,nil:bat,nil:bat,6:lng,false,true,false)

query TT rowsort
io.print(bp)
----
12 values hashing to 0c93b862b714640e965b921e1f8ab8ff

query TT rowsort
io.print(bg)
----
12 values hashing to 661285379ca34c927e10e59d1f92a9e6

statement ok
(cp,cg):= algebra.firstn(a,bp,bg,6:lng,false,true,false)

query TT rowsort
io.print(cp)
----
12 values hashing to 0c93b862b714640e965b921e1f8ab8ff

query TT rowsort
io.print(cg)
----
12 values hashing to 661285379ca34c927e10e59d1f92a9e6

statement ok
(bp,bg):= algebra.firstn(b,nil:bat,nil:bat,7:lng,false,true,false)

query TT rowsort
io.print(bp)
----
14 values hashing to 85ff96c644d3ad69de07d013f0043314

query TT rowsort
io.print(bg)
----
14 values hashing to 8632ba86ef7badd3e6f0eac58a486c97

statement ok
(cp,cg):= algebra.firstn(a,bp,bg,7:lng,false,true,false)

query TT rowsort
io.print(cp)
----
14 values hashing to 85ff96c644d3ad69de07d013f0043314

query TT rowsort
io.print(cg)
----
14 values hashing to 8632ba86ef7badd3e6f0eac58a486c97

statement ok
(bp,bg):= algebra.firstn(b,nil:bat,nil:bat,8:lng,false,true,false)

query TT rowsort
io.print(bp)
----
14 values hashing to 85ff96c644d3ad69de07d013f0043314

query TT rowsort
io.print(bg)
----
14 values hashing to 8632ba86ef7badd3e6f0eac58a486c97

statement ok
(cp,cg):= algebra.firstn(a,bp,bg,8:lng,false,true,false)

query TT rowsort
io.print(cp)
----
14 values hashing to 85ff96c644d3ad69de07d013f0043314

query TT rowsort
io.print(cg)
----
14 values hashing to 8632ba86ef7badd3e6f0eac58a486c97


